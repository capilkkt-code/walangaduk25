<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Walangaduk</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#31326F'
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #31326F 0%, #4A4B8C 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(49, 50, 111, 0.1);
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Hamburger Animation */
        .hamburger-active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .hamburger-active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        .hamburger-active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        
        /* Mobile menu slide animation */
        .mobile-menu-enter {
            animation: slideDown 0.3s ease-out;
        }
        .mobile-menu-exit {
            animation: slideUp 0.3s ease-in;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-6 shadow-lg">
        <div class="container mx-auto px-4 text-center">
            <div class="flex flex-col items-center space-y-4">
                <img src="https://iili.io/KoUNepV.png" alt="Logo" class="h-24 w-24 md:h-32 md:w-32 lg:h-40 lg:w-40 object-contain">
                <div>
                    <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold mb-2 px-2">Aplikasi Walangaduk</h1>
                    <p class="text-sm sm:text-base md:text-lg lg:text-xl mb-2 px-4 max-w-4xl mx-auto">Layanan Registrasi Administrasi Kependudukan Secara Online Oleh Petugas Walangaduk di Desa</p>
                    <p class="text-xs sm:text-sm md:text-base lg:text-lg px-4 max-w-3xl mx-auto">Dinas Kependudukan dan Pencatatan Sipil Kabupaten Kepulauan Tanimbar</p>
                    <div class="mt-3 sm:mt-4 text-center">
                        <div id="currentDateTime" class="text-xs sm:text-sm md:text-base text-white/90 font-medium bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2 inline-block">
                            Loading...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6">
            <div class="flex justify-between items-center py-3 sm:py-4">
                <div class="text-base sm:text-lg lg:text-xl font-semibold text-primary">
                    📱 Menu
                </div>
                
                <!-- Hamburger Button -->
                <button id="hamburger-btn" class="lg:hidden flex flex-col justify-center items-center w-10 h-10 space-y-1.5 focus:outline-none p-2 rounded-lg hover:bg-gray-100 transition-colors" onclick="toggleMenu()">
                    <span class="hamburger-line w-6 h-0.5 bg-primary transition-all duration-300"></span>
                    <span class="hamburger-line w-6 h-0.5 bg-primary transition-all duration-300"></span>
                    <span class="hamburger-line w-6 h-0.5 bg-primary transition-all duration-300"></span>
                </button>
                
                <!-- Desktop Navigation -->
                <div class="hidden lg:flex items-center space-x-2 xl:space-x-6">
                    <button onclick="showPage('dashboard')" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 bg-primary text-white text-sm xl:text-base">Dashboard</button>
                    <button onclick="checkLoginAndShowRegistrasi()" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 text-primary hover:bg-primary hover:text-white text-sm xl:text-base">Registrasi</button>
                    <button onclick="showPage('tentang')" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 text-primary hover:bg-primary hover:text-white text-sm xl:text-base">Tentang Kami</button>
                    <button onclick="showPage('kontak')" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 text-primary hover:bg-primary hover:text-white text-sm xl:text-base">Kontak Kami</button>
                    <button id="logoutBtnDesktop" onclick="logout()" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 bg-red-500 text-white text-sm xl:text-base hidden">Logout</button>
                </div>
            </div>
            
            <!-- Mobile Navigation Menu -->
            <div id="mobile-menu" class="lg:hidden hidden bg-white border-t border-gray-200 shadow-lg">
                <div class="py-2 space-y-1">
                    <button onclick="showPage('dashboard'); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 bg-primary text-white font-medium text-base">📊 Dashboard</button>
                    <button onclick="checkLoginAndShowRegistrasi(); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 font-medium text-base">📝 Registrasi</button>
                    <button onclick="showPage('tentang'); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 font-medium text-base">ℹ️ Tentang Kami</button>
                    <button onclick="showPage('kontak'); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 font-medium text-base">📞 Kontak Kami</button>
                    <button id="logoutBtnMobile" onclick="logout(); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 bg-red-500 text-white hover:bg-red-600 transition-all duration-300 font-medium text-base hidden">🚪 Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Dashboard Page -->
    <div id="dashboard" class="page-content">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-6 sm:py-8 md:py-10 lg:py-12">
            <!-- Welcome Hero Section -->
            <div class="text-center mb-8 sm:mb-12 md:mb-16">
                <div class="bg-gradient-to-br from-primary via-blue-600 to-purple-700 text-white rounded-3xl p-8 sm:p-12 md:p-16 shadow-2xl">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 sm:mb-6">
                            🌊 Selamat Datang di Era Digital Kepulauan Tanimbar
                        </h2>
                        <p class="text-lg sm:text-xl md:text-2xl mb-6 sm:mb-8 opacity-90 leading-relaxed">
                            Menghubungkan setiap pulau, melayani setiap keluarga dengan teknologi modern yang mudah diakses
                        </p>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6 mt-8">
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6">
                                <div class="text-3xl sm:text-4xl mb-2">🏝️</div>
                                <h4 class="font-semibold text-lg mb-2">10 Kecamatan</h4>
                                <p class="text-sm opacity-80">Tersebar di Kepulauan Tanimbar</p>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6">
                                <div class="text-3xl sm:text-4xl mb-2">🏘️</div>
                                <h4 class="font-semibold text-lg mb-2">82+ Desa</h4>
                                <p class="text-sm opacity-80">Terjangkau layanan digital</p>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6">
                                <div class="text-3xl sm:text-4xl mb-2">👥</div>
                                <h4 class="font-semibold text-lg mb-2">Banyaknya Keluarga</h4>
                                <p class="text-sm opacity-80">Telah merasakan kemudahan</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Services Overview -->
            <div class="mb-8 sm:mb-12 md:mb-16">
                <div class="text-center mb-8 sm:mb-12">
                    <h3 class="text-2xl sm:text-3xl md:text-4xl font-bold text-primary mb-4">
                        🎯 Layanan Unggulan Kami
                    </h3>
                    <p class="text-gray-600 text-lg sm:text-xl max-w-3xl mx-auto leading-relaxed">
                        Solusi lengkap administrasi kependudukan yang dirancang khusus untuk masyarakat kepulauan
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8">
                    <!-- Service Card 1 -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-6 sm:p-8 border border-blue-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">👨‍👩‍👧‍👦</span>
                        </div>
                        <h4 class="text-xl font-bold text-blue-700 mb-3">Kartu Keluarga</h4>
                        <p class="text-blue-600 text-sm leading-relaxed">Pembuatan dan pembaruan Kartu Keluarga dengan proses yang cepat dan mudah, langsung dari desa Anda.</p>
                    </div>

                    <!-- Service Card 2 -->
                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-6 sm:p-8 border border-green-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">🆔</span>
                        </div>
                        <h4 class="text-xl font-bold text-green-700 mb-3">KTP Elektronik</h4>
                        <p class="text-green-600 text-sm leading-relaxed">Layanan pembuatan e-KTP dengan teknologi terdepan, memastikan identitas Anda terlindungi dan valid.</p>
                    </div>

                    <!-- Service Card 3 -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl p-6 sm:p-8 border border-purple-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">👶</span>
                        </div>
                        <h4 class="text-xl font-bold text-purple-700 mb-3">Kartu Identitas Anak</h4>
                        <p class="text-purple-600 text-sm leading-relaxed">Memberikan identitas resmi untuk anak-anak, melindungi hak dan masa depan generasi penerus bangsa.</p>
                    </div>

                    <!-- Service Card 4 -->
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl p-6 sm:p-8 border border-orange-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">🍼</span>
                        </div>
                        <h4 class="text-xl font-bold text-orange-700 mb-3">Akta Kelahiran</h4>
                        <p class="text-orange-600 text-sm leading-relaxed">Pencatatan kelahiran yang sah dan legal, memberikan kepastian hukum sejak hari pertama kehidupan.</p>
                    </div>

                    <!-- Service Card 5 -->
                    <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-2xl p-6 sm:p-8 border border-red-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">📤</span>
                        </div>
                        <h4 class="text-xl font-bold text-red-700 mb-3">Surat Pindah & Datang</h4>
                        <p class="text-red-600 text-sm leading-relaxed">Layanan perpindahan penduduk antar wilayah dengan proses yang transparan dan terpercaya.</p>
                    </div>

                    <!-- Service Card 6 -->
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-2xl p-6 sm:p-8 border border-indigo-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">⚰️</span>
                        </div>
                        <h4 class="text-xl font-bold text-indigo-700 mb-3">Akta Kematian</h4>
                        <p class="text-indigo-600 text-sm leading-relaxed">Pencatatan kematian yang menghormati dan memberikan kepastian hukum bagi keluarga yang ditinggalkan.</p>
                    </div>
                </div>
            </div>

            <!-- Real-time Statistics -->
            <div class="mb-8 sm:mb-12 md:mb-16">
                <div class="text-center mb-6 sm:mb-8">
                    <h3 class="text-2xl sm:text-3xl md:text-4xl font-bold text-primary mb-4">
                        📊 Statistik Pelayanan Real-time
                    </h3>
                    <p class="text-gray-600 text-lg sm:text-xl max-w-3xl mx-auto leading-relaxed mb-2">
                        Sistem administrasi kependudukan online yang memudahkan petugas desa dalam melayani masyarakat dengan cepat dan efisien
                    </p>
                    <div class="text-sm text-gray-500">
                        <span class="inline-flex items-center">
                            <span class="w-2 h-2 bg-green-500 rounded-full mr-2 animate-pulse"></span>
                            Data real-time dari AplikasiWalangaduk
                        </span>
                        <span class="mx-2">•</span>
                        <span id="lastUpdate">Loading...</span>
                    </div>
                </div>

                <!-- Service Statistics Cards -->
                <div id="serviceStats" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6 mb-8 sm:mb-12">
                    <!-- Statistics will be loaded here -->
                    <div class="col-span-full text-center py-8">
                        <div class="animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent mx-auto mb-4"></div>
                        <p class="text-gray-500">Memuat statistik pelayanan...</p>
                    </div>
                </div>

                <!-- Service Chart -->
                <div class="bg-white rounded-2xl card-shadow p-6 sm:p-8 mb-8">
                    <div class="text-center mb-6">
                        <h4 class="text-xl sm:text-2xl font-bold text-primary mb-2">
                            📈 Grafik Pelayanan Per Kecamatan
                        </h4>
                        <p class="text-gray-600 text-sm sm:text-base">
                            Distribusi layanan administrasi kependudukan di seluruh kecamatan
                        </p>
                    </div>
                    <div class="relative" style="height: 400px;">
                        <canvas id="serviceChart" class="w-full h-full"></canvas>
                    </div>
                </div>
            </div>

            <!-- Why Choose Us -->
            <div class="mb-8 sm:mb-12 md:mb-16">
                <div class="text-center mb-8 sm:mb-12">
                    <h3 class="text-2xl sm:text-3xl md:text-4xl font-bold text-primary mb-4">
                        ✨ Mengapa Memilih Walangaduk?
                    </h3>
                    <p class="text-gray-600 text-lg sm:text-xl max-w-3xl mx-auto leading-relaxed">
                        Inovasi terdepan yang mengatasi tantangan geografis kepulauan dengan solusi teknologi modern
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 sm:gap-12">
                    <div class="space-y-6">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center flex-shrink-0">
                                <span class="text-white text-xl">🚀</span>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-gray-800 mb-2">Akses Mudah dari Mana Saja</h4>
                                <p class="text-gray-600 leading-relaxed">Tidak perlu lagi perjalanan jauh antar pulau. Layanan dapat diakses dari desa manapun di Kepulauan Tanimbar.</p>
                            </div>
                        </div>

                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0">
                                <span class="text-white text-xl">⚡</span>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-gray-800 mb-2">Proses Cepat & Efisien</h4>
                                <p class="text-gray-600 leading-relaxed">Teknologi digital memungkinkan pemrosesan dokumen yang lebih cepat dengan tingkat akurasi tinggi.</p>
                            </div>
                        </div>


                    </div>

                    <div class="bg-gradient-to-br from-primary to-blue-600 rounded-2xl p-8 text-white">
                        <h4 class="text-2xl font-bold mb-6">📊 Dampak Positif Walangaduk</h4>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span>Waktu Pelayanan</span>
                                <span class="font-bold">↓ 75% Lebih Cepat</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-2">
                                <div class="bg-white h-2 rounded-full w-3/4"></div>
                            </div>

                            <div class="flex justify-between items-center">
                                <span>Biaya Transportasi</span>
                                <span class="font-bold">↓ 90% Hemat</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-2">
                                <div class="bg-white h-2 rounded-full w-9/10"></div>
                            </div>

                            <div class="flex justify-between items-center">
                                <span>Kepuasan Masyarakat</span>
                                <span class="font-bold">↑ 95% Puas</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-2">
                                <div class="bg-white h-2 rounded-full w-11/12"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>



    <!-- Login Page -->
    <div id="login" class="page-content hidden">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-6 sm:py-8 md:py-12">
            <div class="max-w-md mx-auto">
                <div class="bg-white rounded-xl card-shadow p-6 sm:p-8">
                    <div class="text-center mb-6">
                        <div class="w-20 h-20 bg-gradient-to-br from-primary to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-white text-3xl">🔐</span>
                        </div>
                        <h2 class="text-2xl font-bold text-primary mb-2">Login Petugas</h2>
                        <p class="text-gray-600 text-sm">Masuk untuk mengakses Form Registrasi</p>
                    </div>
                    
                    <form id="loginForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Username</label>
                            <input type="text" name="username" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                            <input type="password" name="password" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                        </div>
                        <button type="submit" class="w-full bg-primary text-white py-3 rounded-lg font-semibold hover:bg-opacity-90 transition-all duration-300 shadow-md">
                            🔑 Masuk
                        </button>
                    </form>
                    
                    <div class="mt-6 text-center">
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div class="flex items-center justify-center mb-2">
                                <span class="text-blue-600 text-lg mr-2">ℹ️</span>
                                <h4 class="text-blue-800 font-semibold text-sm">Informasi Login</h4>
                            </div>
                            <p class="text-blue-700 text-xs leading-relaxed">
                                Gunakan username dan password yang telah diberikan oleh admin sistem untuk mengakses form registrasi administrasi kependudukan.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Registrasi Page -->
    <div id="registrasi" class="page-content hidden">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-3 sm:py-4 md:py-6 lg:py-8">
            <div class="max-w-xs sm:max-w-lg md:max-w-2xl lg:max-w-4xl xl:max-w-5xl mx-auto">
                <!-- Logout Button -->
                <div class="mb-4 flex justify-between items-center">
                    <div class="text-sm text-gray-600">
                        <span class="inline-flex items-center">
                            <span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span>
                            Login sebagai: <span id="loggedInUser" class="font-semibold text-primary ml-1">-</span>
                        </span>
                    </div>
                    <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-600 transition-colors flex items-center">
                        <span class="mr-2">🚪</span>
                        Logout
                    </button>
                </div>
                
                <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-3 sm:p-4 md:p-6 lg:p-8">
                    <h2 class="text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-primary mb-4 sm:mb-6 lg:mb-8 text-center px-1 sm:px-2 leading-tight">Form Registrasi Administrasi Kependudukan</h2>
                    
                    <form id="registrationForm" class="space-y-4 sm:space-y-5 md:space-y-6">
                        <!-- Tanggal dan Jenis Pelaporan -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Informasi Pelaporan
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Tanggal</label>
                                    <input type="date" name="tanggal" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Jenis Pelaporan</label>
                                    <select name="jenipelaporan" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                        <option value="">Pilih Jenis Pelaporan</option>
                                        <option value="KK">Kartu Keluarga (KK)</option>
                                        <option value="KTP EL">KTP Elektronik</option>
                                        <option value="KIA">Kartu Identitas Anak</option>
                                        <option value="SKPWNI">Surat Keterangan Pindah WNI</option>
                                        <option value="SKDWNI">Surat Keterangan Datang WNI</option>
                                        <option value="Akta Kelahiran">Akta Kelahiran</option>
                                        <option value="Akta Kematian">Akta Kematian</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Data Petugas -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Data Petugas
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Petugas</label>
                                    <input type="text" name="namapetugas" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">NIP Petugas</label>
                                    <input type="text" name="nip" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Instansi</label>
                                    <input type="text" name="namainstansi" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">No Handphone</label>
                                    <input type="tel" name="telp" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Email</label>
                                    <input type="email" name="email" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                            </div>
                        </div>

                        <!-- Data Pemohon -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Data Pemohon
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div class="md:col-span-2">
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Lengkap</label>
                                    <input type="text" name="namalengkap" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Tempat Lahir</label>
                                    <input type="text" name="tempatlahir" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Tanggal Lahir</label>
                                    <input type="date" name="tanggallahir" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Jenis Kelamin</label>
                                    <select name="jeniskelamin" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                        <option value="">Pilih Jenis Kelamin</option>
                                        <option value="Laki-laki">Laki-laki</option>
                                        <option value="Perempuan">Perempuan</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Ibu</label>
                                    <input type="text" name="namaibu" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Ayah</label>
                                    <input type="text" name="namaayah" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                            </div>
                        </div>

                        <!-- Alamat -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Alamat
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Kecamatan</label>
                                    <select name="kecamatan" id="kecamatan" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base" onchange="updateDesa()">
                                        <option value="">Pilih Kecamatan</option>
                                        <option value="Tanimbar Selatan">Tanimbar Selatan</option>
                                        <option value="Selaru">Selaru</option>
                                        <option value="Wertamrian">Wertamrian</option>
                                        <option value="Wermaktian">Wermaktian</option>
                                        <option value="Tanimbar Utara">Tanimbar Utara</option>
                                        <option value="Fordata">Fordata</option>
                                        <option value="Wuarlabobar">Wuarlabobar</option>
                                        <option value="Kormomolin">Kormomolin</option>
                                        <option value="Nirunmas">Nirunmas</option>
                                        <option value="Molumaru">Molumaru</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Desa</label>
                                    <select name="desakelurahan" id="desa" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                        <option value="">Pilih Desa</option>
                                    </select>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">RT/RW</label>
                                    <input type="text" name="rtrw" required placeholder="Contoh: RT 001/RW 002" class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                            </div>
                        </div>

                        <!-- Upload Berkas -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Upload Berkas
                            </h3>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 sm:p-4 mb-4">
                                <div class="flex items-start space-x-2">
                                    <div class="text-yellow-600 text-lg flex-shrink-0">⚠️</div>
                                    <div>
                                        <h4 class="text-yellow-800 font-semibold text-sm mb-1">Catatan Penting:</h4>
                                        <p class="text-yellow-700 text-xs sm:text-sm leading-relaxed">
                                            Berkas yang di upload harus asli dalam bentuk PDF. Pastikan dokumen sudah dipindai dengan jelas dan dapat dibaca.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="border-2 border-dashed border-gray-300 rounded-md p-4 sm:p-6 text-center hover:border-primary transition-colors">
                                <input type="file" id="fileUpload" name="unggahberkas" multiple accept=".pdf,.jpg,.jpeg,.png" class="hidden" onchange="handleFileUpload(event)">
                                <label for="fileUpload" class="cursor-pointer block">
                                    <div class="text-gray-500">
                                        <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                            <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                        </svg>
                                        <p class="mt-2 text-sm sm:text-base font-medium">Klik untuk upload berkas</p>
                                        <p class="text-xs sm:text-sm mt-1">Format: PDF, JPG, PNG (Max 5MB)</p>
                                    </div>
                                </label>
                                <div id="fileList" class="mt-3 sm:mt-4 text-left"></div>
                            </div>
                        </div>

                        <!-- Syarat dan Ketentuan -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <div class="flex items-start space-x-3">
                                <input type="checkbox" id="syaratKetentuan" name="syaratdanketentuan" required class="mt-1 h-5 w-5 sm:h-6 sm:w-6 text-primary border-gray-300 rounded focus:ring-primary">
                                <label for="syaratKetentuan" class="text-xs sm:text-sm text-gray-700 leading-relaxed">
                                    Saya menyetujui <a href="#" class="text-primary underline font-medium">syarat dan ketentuan</a> yang berlaku dan menjamin kebenaran data yang saya berikan.
                                </label>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center pt-4 sm:pt-6 space-y-4">
                            <button type="submit" class="w-full sm:w-auto bg-primary text-white px-6 sm:px-8 lg:px-12 py-3 sm:py-4 rounded-md text-base sm:text-lg font-semibold hover:bg-opacity-90 transition-all duration-300 shadow-md">
                                Kirim Data Registrasi
                            </button>
                            
                            <div class="text-center">
                                <p class="text-xs text-gray-500 mt-2">
                                    🔗 Terhubung dengan database AplikasiWalangaduk
                                </p>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Tentang Kami Page -->
    <div id="tentang" class="page-content hidden">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 md:py-8 lg:py-12">
            <div class="max-w-xs sm:max-w-lg md:max-w-2xl lg:max-w-4xl mx-auto">
                <!-- Hero Section -->
                <div class="text-center mb-8 sm:mb-12">
                    <div class="bg-gradient-to-br from-primary via-blue-600 to-purple-700 text-white rounded-3xl p-8 sm:p-12 shadow-2xl">
                        <h2 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold mb-4">
                            🌊 Tentang Walangaduk
                        </h2>
                        <p class="text-lg sm:text-xl opacity-90 max-w-2xl mx-auto leading-relaxed">
                            Menjembatani jarak, menghubungkan harapan - Inovasi digital untuk kepulauan yang lebih maju
                        </p>
                    </div>
                </div>

                <!-- Story Section -->
                <div class="bg-white rounded-2xl card-shadow p-6 sm:p-8 mb-8">
                    <h3 class="text-xl sm:text-2xl font-bold text-primary mb-6 flex items-center">
                        🏝️ Cerita Kami
                    </h3>
                    <div class="prose prose-gray max-w-none">
                        <p class="text-gray-700 leading-relaxed mb-4">
                            Di tengah hamparan laut biru Kepulauan Tanimbar, terdapat tantangan yang telah lama dihadapi masyarakat - <strong>jarak yang memisahkan</strong>. Untuk mengurus dokumen kependudukan, warga harus menempuh perjalanan laut yang panjang dan mahal.
                        </p>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            <strong>Walangaduk</strong> lahir dari kepedulian dan inovasi Dinas Kependudukan dan Pencatatan Sipil Kabupaten Kepulauan Tanimbar. Kami percaya bahwa <em>setiap warga, di pulau manapun, berhak mendapatkan pelayanan yang mudah dan berkualitas</em>.
                        </p>
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                            <p class="text-blue-800 font-medium italic">
                                "Walangaduk bukan sekadar aplikasi - ini adalah jembatan digital yang menghubungkan setiap keluarga di kepulauan dengan layanan pemerintah yang mereka butuhkan."
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Vision Mission -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8 mb-8">
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-6 sm:p-8 border border-blue-200">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">👁️</span>
                        </div>
                        <h4 class="text-xl font-bold text-blue-700 mb-4">Visi Kami</h4>
                        <p class="text-blue-600 leading-relaxed">
                            Mewujudkan Kepulauan Tanimbar sebagai daerah kepulauan terdepan dalam pelayanan administrasi kependudukan digital yang <strong>inklusif, inovatif, dan berkelanjutan</strong>.
                        </p>
                    </div>

                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-6 sm:p-8 border border-green-200">
                        <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">🎯</span>
                        </div>
                        <h4 class="text-xl font-bold text-green-700 mb-4">Misi Kami</h4>
                        <ul class="text-green-600 space-y-2 text-sm leading-relaxed">
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">•</span>
                                Memberikan akses layanan kependudukan yang mudah dan terjangkau
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">•</span>
                                Meningkatkan kualitas hidup masyarakat kepulauan melalui teknologi
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">•</span>
                                Membangun sistem pelayanan yang transparan dan akuntabel
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Values Section -->
                <div class="bg-white rounded-2xl card-shadow p-6 sm:p-8 mb-8">
                    <h3 class="text-xl sm:text-2xl font-bold text-primary mb-6 text-center">
                        ⭐ Nilai-Nilai Kami
                    </h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">🤝</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Kepedulian</h5>
                            <p class="text-xs text-gray-600">Mengutamakan kebutuhan masyarakat</p>
                        </div>
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">⚡</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Inovasi</h5>
                            <p class="text-xs text-gray-600">Terus berinovasi untuk kemajuan</p>
                        </div>
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">🎯</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Integritas</h5>
                            <p class="text-xs text-gray-600">Jujur dan dapat dipercaya</p>
                        </div>
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">🌟</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Keunggulan</h5>
                            <p class="text-xs text-gray-600">Memberikan yang terbaik</p>
                        </div>
                    </div>
                </div>

                <!-- Impact Section -->
                <div class="bg-gradient-to-r from-primary to-blue-600 rounded-2xl p-6 sm:p-8 text-white mb-8">
                    <h3 class="text-xl sm:text-2xl font-bold mb-6 text-center">
                        🚀 Dampak Positif Walangaduk
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="text-3xl sm:text-4xl font-bold mb-2">10,000+</div>
                            <p class="text-sm opacity-90">Dokumen Telah Diproses</p>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl sm:text-4xl font-bold mb-2">82</div>
                            <p class="text-sm opacity-90">Desa Terjangkau</p>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl sm:text-4xl font-bold mb-2">95%</div>
                            <p class="text-sm opacity-90">Tingkat Kepuasan</p>
                        </div>
                    </div>
                    <div class="mt-8 text-center">
                        <p class="text-lg opacity-90 italic">
                            "Bersama-sama membangun masa depan digital Kepulauan Tanimbar yang lebih cerah"
                        </p>
                    </div>
                </div>

                <!-- Location Map Section -->
                <div class="bg-white rounded-2xl card-shadow p-6 sm:p-8">
                    <h3 class="text-xl sm:text-2xl font-bold text-primary mb-6 text-center flex items-center justify-center">
                        🗺️ Lokasi Kantor Kami
                    </h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8">
                        <!-- Map Embed -->
                        <div class="order-2 lg:order-1">
                            <div class="bg-gray-100 rounded-xl overflow-hidden shadow-lg h-64 sm:h-80 relative">
                                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d987..!2d131..!3d-7..!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2d2755c0292f2a65%3A0x97d389f87f0d32!2sDinas%20Kependudukan%20dan%20Catatan%20Sipil%20Kabupaten%20Tanimbar!5e0!3m2!1sid!2sid!4v..!5m2!1sid!2sid" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                                <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent pointer-events-none rounded-xl"></div>
                            </div>
                            <div class="mt-4 text-center">
                                <a href="https://maps.app.goo.gl/Vtd6ps9dDmWdvTn27" 
                                   target="_blank" 
                                   class="inline-flex items-center bg-primary text-white px-6 py-3 rounded-lg hover:bg-opacity-90 transition-all duration-300 font-medium shadow-md">
                                    <span class="mr-2">📍</span>
                                    Buka di Google Maps
                                </a>
                            </div>
                        </div>
                        
                        <!-- Location Info -->
                        <div class="order-1 lg:order-2">
                            <div class="space-y-4">
                                <div class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-lg">🏢</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-blue-800 mb-1">Alamat Lengkap</h4>
                                            <p class="text-blue-700 text-sm leading-relaxed">
                                                Dinas Kependudukan dan Pencatatan Sipil<br>
                                                Kabupaten Kepulauan Tanimbar<br>
                                                Jl. Ir. Soekarno-Saumlaki<br>
                                                Provinsi Maluku
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-green-50 border border-green-200 rounded-xl p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-lg">⏰</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-green-800 mb-1">Jam Operasional</h4>
                                            <div class="text-green-700 text-sm space-y-1">
                                                <p><strong>Senin - Jumat:</strong> 08:00 - 16:00 WIT</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-purple-50 border border-purple-200 rounded-xl p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-lg">🚗</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-purple-800 mb-1">Akses Transportasi</h4>
                                            <p class="text-purple-700 text-sm leading-relaxed">
                                                Dapat diakses melalui transportasi darat dari pusat kota Saumlaki. 
                                                Tersedia area parkir untuk kendaraan roda dua dan roda empat.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Kontak Kami Page -->
    <div id="kontak" class="page-content hidden">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 md:py-8 lg:py-12">
            <div class="max-w-xs sm:max-w-lg md:max-w-2xl lg:max-w-4xl mx-auto">
                <div class="text-center mb-6 sm:mb-8 md:mb-10 lg:mb-12">
                    <h2 class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold text-primary mb-2 sm:mb-4">📞 Kontak Kami</h2>
                    <p class="text-sm sm:text-base md:text-lg lg:text-xl text-gray-600 px-2">Hubungi kami untuk bantuan dan informasi lebih lanjut</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 md:gap-8">
                    <!-- Contact Information -->
                    <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-4 sm:p-6 md:p-8">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-primary mb-4 sm:mb-6 flex items-center">
                            📋 Informasi Kontak
                        </h3>
                        
                        <div class="space-y-3 sm:space-y-4">


                            <div class="flex items-start space-x-3 sm:space-x-4">
                                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                                    <span class="text-white text-lg sm:text-xl">📞</span>
                                </div>
                                <div class="min-w-0 flex-1">
                                    <h4 class="text-sm sm:text-base font-semibold text-gray-800 mb-1">Telepon</h4>
                                    <p class="text-xs sm:text-sm text-gray-600">+62 xxx-xxxx-xxxx</p>
                                </div>
                            </div>

                            <div class="flex items-start space-x-3 sm:space-x-4">
                                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                                    <span class="text-white text-lg sm:text-xl">✉️</span>
                                </div>
                                <div class="min-w-0 flex-1">
                                    <h4 class="text-sm sm:text-base font-semibold text-gray-800 mb-1">Email</h4>
                                    <p class="text-xs sm:text-sm text-gray-600">dukcapil@tanimbar.go.id</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Form -->
                    <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-4 sm:p-6 md:p-8">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-primary mb-4 sm:mb-6 border-b border-gray-200 pb-2">
                            Kirim Pesan
                        </h3>
                        
                        <form id="contactForm" class="space-y-3 sm:space-y-4">
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Lengkap</label>
                                <input type="text" name="nama" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                            </div>
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">No WhatsApp</label>
                                <input type="tel" name="whatsapp" required placeholder="Contoh: 628123456789" class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                            </div>
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Email</label>
                                <input type="email" name="email" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                            </div>
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Pesan</label>
                                <textarea name="pesan" rows="4" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base resize-none"></textarea>
                            </div>
                            <button type="submit" class="w-full bg-green-600 text-white py-3 sm:py-4 rounded-md text-sm sm:text-base font-semibold hover:bg-green-700 transition-all duration-300 shadow-md flex items-center justify-center">
                                <span class="mr-2">📱</span>
                                Kirim via WhatsApp
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Location Map Section -->
                <div class="mt-6 sm:mt-8">
                    <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-4 sm:p-6 md:p-8">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-primary mb-4 sm:mb-6 text-center flex items-center justify-center">
                            🗺️ Lokasi Kantor
                        </h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
                            <!-- Map -->
                            <div class="lg:col-span-2">
                                <div class="bg-gray-100 rounded-xl overflow-hidden shadow-lg h-64 sm:h-80 lg:h-96 relative">
                                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d987..!2d131..!3d-7..!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2d2755c0292f2a65%3A0x97d389f87f0d32!2sDinas%20Kependudukan%20dan%20Catatan%20Sipil%20Kabupaten%20Tanimbar!5e0!3m2!1sid!2sid!4v..!5m2!1sid!2sid" width="100%" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent pointer-events-none rounded-xl"></div>
                                </div>
                                <div class="mt-4 text-center">
                                    <a href="https://maps.app.goo.gl/Vtd6ps9dDmWdvTn27" 
                                       target="_blank" 
                                       class="inline-flex items-center bg-primary text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg hover:bg-opacity-90 transition-all duration-300 font-medium shadow-md text-sm sm:text-base">
                                        <span class="mr-2">📍</span>
                                        Lihat di Google Maps
                                    </a>
                                </div>
                            </div>
                            
                            <!-- Quick Info -->
                            <div class="space-y-3 sm:space-y-4">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                                    <div class="flex items-start space-x-2 sm:space-x-3">
                                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-sm sm:text-lg">🏢</span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <h4 class="font-semibold text-blue-800 mb-1 text-xs sm:text-sm">Alamat</h4>
                                            <p class="text-blue-700 text-xs leading-relaxed">
                                                Dinas Kependudukan dan Pencatatan Sipil<br>
                                                Kabupaten Kepulauan Tanimbar<br>
                                                Jl. Ir. Soekarno-Saumlaki<br>
                                                Provinsi Maluku
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4">
                                    <div class="flex items-start space-x-2 sm:space-x-3">
                                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-sm sm:text-lg">⏰</span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <h4 class="font-semibold text-green-800 mb-1 text-xs sm:text-sm">Jam Buka</h4>
                                            <div class="text-green-700 text-xs space-y-1">
                                                <p><strong>Sen-Jum:</strong> 08:00-16:00</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4">
                                    <div class="flex items-start space-x-2 sm:space-x-3">
                                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-orange-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-sm sm:text-lg">🚗</span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <h4 class="font-semibold text-orange-800 mb-1 text-xs sm:text-sm">Parkir</h4>
                                            <p class="text-orange-700 text-xs leading-relaxed">
                                                Area parkir tersedia untuk motor dan mobil
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="gradient-bg text-white py-4 sm:py-6 md:py-8 mt-6 sm:mt-8 md:mt-12 lg:mt-16">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 text-center">
            <div class="flex flex-col items-center space-y-2 sm:space-y-3">
                <img src="https://iili.io/K9rv7pt.png" alt="Logo Footer" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto">
                <p class="text-xs sm:text-sm md:text-base px-2 leading-relaxed max-w-2xl">
                    &copy; 2025 Aplikasi Walangaduk<br class="sm:hidden">
                    <span class="hidden sm:inline"> - </span>Dinas Kependudukan dan Pencatatan Sipil<br class="sm:hidden">
                    <span class="hidden sm:inline"> </span>Kabupaten Kepulauan Tanimbar
                </p>
                <p class="text-xs text-white/80">All rights reserved</p>
            </div>
        </div>
    </footer>



    <script>
        // Global variables
        let uploadedFiles = [];
        let serviceChart = null;
        let autoRefreshInterval;
        let loginCredentials = [];
        let isLoggedIn = false;
        let currentUser = null;

        // Desa data mapping
        const desaData = {
            "Tanimbar Selatan": ["Saumlaki", "Saumlaki Utara", "Wowonda", "Ilngei", "Kabiarat", "Lauran", "Sifnana", "Olilit Raya", "Lermatang", "Latdalam", "Bomaki", "Matakus"],
            "Selaru": ["Adaut", "Namtabung", "Kandar", "Lingat", "Fursuy", "Werain", "Eliasa"],
            "Wertamrian": ["Tumbur", "Lorulun", "Atubul Dol", "Amdasa", "Sangliat Krawain", "Arui Bab", "Arui Das", "Sangliat Dol", "Atubul Da"],
            "Wermaktian": ["Kamatubun", "Rumah Salut", "Welutu", "Themin", "Weratan", "Wermatan", "Otemer", "Makatian", "Marantutul"],
            "Tanimbar Utara": ["Lelingluan", "Ritabel", "Ridool", "Watidal", "Keliobar", "Kelaan", "Lamdesar Barat", "Lamdesar Timur"],
            "Fordata": ["Romean", "Rumngeur", "Awear", "Sofyanin", "Walerang", "Adodo Fordata"],
            "Wuarlabobar": ["Abat", "Labobar", "Watmasa", "Awear Rumngeur", "Karatat", "Wunlah", "Kiloon", "Lingada", "Teineman", "Wabar", "Romnus"],
            "Kormomolin": ["Lumasebu", "Kilmasa", "Meyano Bab", "Alusi Krawain", "Alusi Kelaan", "Alusi Bukjalim", "Alusi Tamrian", "Alusi Batjas", "Lorwembun", "Meyano Das"],
            "Nirunmas": ["Arma", "Watmuri", "Manglusi", "Tutukembong", "Waturu"],
            "Molumaru": ["Wedangkou", "Adodo Molu", "Wulmasa", "Tutunametal", "Nurkat"]
        };

        // Service type icons and names
        const serviceIcons = {
            'KK': '👨‍👩‍👧‍👦',
            'KTP EL': '🆔',
            'KIA': '👶',
            'SKPWNI': '📤',
            'SKDWNI': '📥',
            'Akta Kelahiran': '🍼',
            'Akta Kematian': '⚰️'
        };

        const serviceNames = {
            'KK': 'Kartu Keluarga',
            'KTP EL': 'KTP Elektronik',
            'KIA': 'Kartu Identitas Anak',
            'SKPWNI': 'SK Pindah WNI',
            'SKDWNI': 'SK Datang WNI',
            'Akta Kelahiran': 'Akta Kelahiran',
            'Akta Kematian': 'Akta Kematian'
        };

        // Load login credentials from Google Sheets
        async function loadLoginCredentials() {
            try {
                console.log('🔐 Memuat kredensial login dari Google Sheets...');
                
                // Google Sheets CSV URL for login credentials - Your provided link
                const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQe1VRxHbaCptL3iB_UUitoRw_BF6DRWSuUw3-w5evnSe-nxUPGLKo7TNSjy8rwL8r0nL5RHmK2ALiy/pub?gid=0&single=true&output=csv';
                
                // Multiple CORS proxy options
                const proxyUrls = [
                    'https://api.allorigins.win/get?url=' + encodeURIComponent(csvUrl),
                    'https://corsproxy.io/?' + encodeURIComponent(csvUrl)
                ];
                
                let csvText = null;
                
                // Try each proxy until one works
                for (const proxyUrl of proxyUrls) {
                    try {
                        console.log('🔄 Mencoba proxy untuk kredensial:', proxyUrl);
                        const response = await fetch(proxyUrl, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json, text/plain, */*',
                                'Content-Type': 'application/json'
                            }
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                        }
                        
                        const data = await response.json();
                        csvText = data.contents || data.data || data;
                        
                        if (typeof csvText === 'string' && csvText.length > 0) {
                            console.log('✅ Berhasil mengakses kredensial via proxy');
                            break;
                        }
                    } catch (error) {
                        console.warn('⚠️ Proxy gagal untuk kredensial:', error.message);
                        continue;
                    }
                }
                
                // If all proxies failed, try direct access
                if (!csvText) {
                    try {
                        console.log('🔄 Mencoba akses langsung ke Google Sheets untuk kredensial...');
                        const directResponse = await fetch(csvUrl, {
                            method: 'GET',
                            mode: 'cors',
                            headers: {
                                'Accept': 'text/csv, text/plain, */*'
                            }
                        });
                        
                        if (directResponse.ok) {
                            csvText = await directResponse.text();
                            console.log('✅ Berhasil akses langsung kredensial');
                        }
                    } catch (directError) {
                        console.warn('⚠️ Akses langsung gagal untuk kredensial:', directError.message);
                    }
                }
                
                if (!csvText || csvText.length === 0) {
                    console.log('❌ Gagal memuat kredensial, menggunakan default');
                    // Default credentials as fallback
                    loginCredentials = [
                        { username: 'admin', password: 'admin123', nama: 'Administrator' },
                        { username: 'petugas', password: 'petugas123', nama: 'Petugas Desa' }
                    ];
                    return;
                }
                
                // Parse CSV data
                console.log('📊 Memproses data kredensial CSV...');
                const lines = csvText.replace(/\r\n/g, '\n').replace(/\r/g, '\n').trim().split('\n');
                
                if (lines.length < 2) {
                    throw new Error('Data kredensial tidak memiliki cukup baris');
                }
                
                // Enhanced CSV parser
                function parseCSVLine(line) {
                    const result = [];
                    let current = '';
                    let inQuotes = false;
                    
                    for (let i = 0; i < line.length; i++) {
                        const char = line[i];
                        
                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            result.push(current.trim().replace(/^"|"$/g, ''));
                            current = '';
                        } else {
                            current += char;
                        }
                    }
                    result.push(current.trim().replace(/^"|"$/g, ''));
                    return result;
                }
                
                const headers = parseCSVLine(lines[0]).map(h => h.toLowerCase().trim());
                console.log('📋 Headers kredensial CSV:', headers);
                
                // Process credentials data
                loginCredentials = [];
                
                for (let i = 1; i < lines.length; i++) {
                    try {
                        const row = parseCSVLine(lines[i]);
                        
                        if (row.length < 2 || !row.some(cell => cell.trim())) {
                            continue; // Skip empty rows
                        }
                        
                        const rowData = {};
                        headers.forEach((header, index) => {
                            rowData[header] = (row[index] || '').trim();
                        });
                        
                        // Get username, password, and name
                        const username = rowData['username'] || rowData['user'] || '';
                        const password = rowData['password'] || rowData['pass'] || '';
                        const nama = rowData['nama'] || rowData['name'] || rowData['fullname'] || username;
                        
                        if (username && password) {
                            loginCredentials.push({
                                username: username,
                                password: password,
                                nama: nama
                            });
                        }
                        
                    } catch (rowError) {
                        console.warn(`⚠️ Error memproses baris kredensial ${i}:`, rowError);
                        continue;
                    }
                }
                
                console.log(`✅ Berhasil memuat ${loginCredentials.length} kredensial login`);
                
                // Add default credentials if none loaded
                if (loginCredentials.length === 0) {
                    console.log('⚠️ Tidak ada kredensial valid, menggunakan default');
                    loginCredentials = [
                        { username: 'admin', password: 'admin123', nama: 'Administrator' },
                        { username: 'petugas', password: 'petugas123', nama: 'Petugas Desa' }
                    ];
                }
                
            } catch (error) {
                console.error('❌ Error loading login credentials:', error);
                // Use default credentials on error
                loginCredentials = [
                    { username: 'admin', password: 'admin123', nama: 'Administrator' },
                    { username: 'petugas', password: 'petugas123', nama: 'Petugas Desa' }
                ];
                console.log('🔧 Menggunakan kredensial default');
            }
        }

        // Check login and show registration page
        function checkLoginAndShowRegistrasi() {
            if (isLoggedIn) {
                showPage('registrasi');
            } else {
                showPage('login');
            }
        }

        // Login function
        async function performLogin(username, password) {
            console.log('🔐 Mencoba login dengan username:', username);
            
            // Check credentials
            const user = loginCredentials.find(cred => 
                cred.username === username && cred.password === password
            );
            
            if (user) {
                isLoggedIn = true;
                currentUser = user;
                
                // Update UI
                document.getElementById('loggedInUser').textContent = user.nama;
                document.getElementById('logoutBtnDesktop').classList.remove('hidden');
                document.getElementById('logoutBtnMobile').classList.remove('hidden');
                
                // Store login state in localStorage
                localStorage.setItem('walangaduk_login', JSON.stringify({
                    isLoggedIn: true,
                    user: user,
                    timestamp: Date.now()
                }));
                
                console.log('✅ Login berhasil untuk:', user.nama);
                return true;
            } else {
                console.log('❌ Login gagal - kredensial tidak valid');
                return false;
            }
        }

        // Logout function
        function logout() {
            isLoggedIn = false;
            currentUser = null;
            
            // Update UI
            document.getElementById('loggedInUser').textContent = '-';
            document.getElementById('logoutBtnDesktop').classList.add('hidden');
            document.getElementById('logoutBtnMobile').classList.add('hidden');
            
            // Clear localStorage
            localStorage.removeItem('walangaduk_login');
            
            // Show success message
            const logoutDiv = document.createElement('div');
            logoutDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-8 py-6 rounded-xl shadow-2xl z-50 text-center';
            logoutDiv.innerHTML = `
                <div class="text-4xl mb-4">👋</div>
                <h3 class="text-xl font-bold mb-2">Logout Berhasil!</h3>
                <p class="text-sm opacity-90">Anda telah keluar dari sistem</p>
            `;
            document.body.appendChild(logoutDiv);
            
            setTimeout(() => {
                logoutDiv.remove();
            }, 3000);
            
            // Redirect to dashboard
            showPage('dashboard');
            
            console.log('✅ Logout berhasil');
        }

        // Check stored login state
        function checkStoredLogin() {
            try {
                const stored = localStorage.getItem('walangaduk_login');
                if (stored) {
                    const loginData = JSON.parse(stored);
                    
                    // Check if login is still valid (24 hours)
                    const now = Date.now();
                    const loginTime = loginData.timestamp || 0;
                    const hoursDiff = (now - loginTime) / (1000 * 60 * 60);
                    
                    if (hoursDiff < 24 && loginData.isLoggedIn && loginData.user) {
                        isLoggedIn = true;
                        currentUser = loginData.user;
                        
                        // Update UI
                        document.getElementById('loggedInUser').textContent = loginData.user.nama;
                        document.getElementById('logoutBtnDesktop').classList.remove('hidden');
                        document.getElementById('logoutBtnMobile').classList.remove('hidden');
                        
                        console.log('✅ Login state restored untuk:', loginData.user.nama);
                        return true;
                    } else {
                        // Clear expired login
                        localStorage.removeItem('walangaduk_login');
                        console.log('⚠️ Login expired, cleared from storage');
                    }
                }
            } catch (error) {
                console.error('❌ Error checking stored login:', error);
                localStorage.removeItem('walangaduk_login');
            }
            return false;
        }

        // Initialize login form
        function initializeLoginForm() {
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    
                    try {
                        const formData = new FormData(this);
                        const username = formData.get('username').trim();
                        const password = formData.get('password').trim();
                        
                        if (!username || !password) {
                            alert('❌ Username dan password harus diisi!');
                            return;
                        }
                        
                        // Show loading
                        submitBtn.textContent = '🔄 Memverifikasi...';
                        submitBtn.disabled = true;
                        
                        // Perform login
                        const loginSuccess = await performLogin(username, password);
                        
                        if (loginSuccess) {
                            // Show success message
                            const successDiv = document.createElement('div');
                            successDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-8 py-6 rounded-xl shadow-2xl z-50 text-center';
                            successDiv.innerHTML = `
                                <div class="text-4xl mb-4">✅</div>
                                <h3 class="text-xl font-bold mb-2">Login Berhasil!</h3>
                                <p class="text-sm opacity-90">Selamat datang, ${currentUser.nama}</p>
                            `;
                            document.body.appendChild(successDiv);
                            
                            setTimeout(() => {
                                successDiv.remove();
                                showPage('registrasi');
                            }, 2000);
                            
                            // Reset form
                            this.reset();
                            
                        } else {
                            // Show error message
                            const errorDiv = document.createElement('div');
                            errorDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white px-8 py-6 rounded-xl shadow-2xl z-50 text-center';
                            errorDiv.innerHTML = `
                                <div class="text-4xl mb-4">❌</div>
                                <h3 class="text-xl font-bold mb-2">Login Gagal!</h3>
                                <p class="text-sm opacity-90">Username atau password salah</p>
                            `;
                            document.body.appendChild(errorDiv);
                            
                            setTimeout(() => {
                                errorDiv.remove();
                            }, 4000);
                        }
                        
                    } catch (error) {
                        console.error('❌ Error in login:', error);
                        alert('❌ Terjadi kesalahan saat login. Silakan coba lagi.');
                    } finally {
                        setTimeout(() => {
                            submitBtn.textContent = originalText;
                            submitBtn.disabled = false;
                        }, 2000);
                    }
                });
            }
        }

        // Mobile menu toggle
        function toggleMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
                mobileMenu.classList.add('mobile-menu-enter');
                hamburgerBtn.classList.add('hamburger-active');
                
                setTimeout(() => {
                    mobileMenu.classList.remove('mobile-menu-enter');
                }, 300);
            } else {
                mobileMenu.classList.add('mobile-menu-exit');
                hamburgerBtn.classList.remove('hamburger-active');
                
                setTimeout(() => {
                    mobileMenu.classList.add('hidden');
                    mobileMenu.classList.remove('mobile-menu-exit');
                }, 300);
            }
        }



        // Navigation functions
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            
            document.getElementById(pageId).classList.remove('hidden');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('text-primary');
            });
            
            document.querySelectorAll('.nav-btn-mobile').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('text-primary');
            });
            
            if (event && event.target) {
                event.target.classList.add('bg-primary', 'text-white');
                event.target.classList.remove('text-primary');
            }
            
            // Load dashboard data when switching to dashboard
            if (pageId === 'dashboard') {
                setTimeout(() => {
                    loadDashboardData();
                }, 100);
            }
        }

        // Update desa dropdown
        function updateDesa() {
            const kecamatan = document.getElementById('kecamatan').value;
            const desaSelect = document.getElementById('desa');
            
            desaSelect.innerHTML = '<option value="">Pilih Desa</option>';
            
            if (kecamatan && desaData[kecamatan]) {
                desaData[kecamatan].forEach(desa => {
                    const option = document.createElement('option');
                    option.value = desa;
                    option.textContent = desa;
                    desaSelect.appendChild(option);
                });
            }
        }

        // Handle file upload
        function handleFileUpload(event) {
            const files = event.target.files;
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            uploadedFiles = [];
            
            Array.from(files).forEach(file => {
                if (file.size > 5 * 1024 * 1024) {
                    alert(`File ${file.name} terlalu besar. Maksimal 5MB.`);
                    return;
                }
                
                const fileItem = document.createElement('div');
                fileItem.className = 'flex items-center justify-between bg-white p-3 rounded border mb-2';
                fileItem.innerHTML = `
                    <span class="text-sm text-gray-700">${file.name}</span>
                    <span class="text-xs text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</span>
                `;
                fileList.appendChild(fileItem);
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedFiles.push({
                        name: file.name,
                        type: file.type,
                        data: e.target.result.split(',')[1]
                    });
                };
                reader.readAsDataURL(file);
            });
        }

        // Show instructions for Google Apps Script setup
        function showGoogleScriptInstructions() {
            const instructionsDiv = document.createElement('div');
            instructionsDiv.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4';
            instructionsDiv.innerHTML = `
                <div class="bg-white rounded-xl p-6 max-w-2xl max-h-96 overflow-y-auto">
                    <h3 class="text-xl font-bold text-primary mb-4">📋 Cara Setup Google Apps Script</h3>
                    <div class="space-y-3 text-sm">
                        <div class="bg-blue-50 p-3 rounded-lg">
                            <h4 class="font-semibold text-blue-800 mb-2">1. Setup Google Sheets & Drive</h4>
                            <p class="text-blue-700 text-xs">• Buat Google Sheets dengan ID: <code>1xhwRfxZ7dnWGvVucqKKMCzJ93MSVKzZoHZb4PNEuEOU</code></p>
                            <p class="text-blue-700 text-xs">• Buat Google Drive Folder dengan ID: <code>1O9xbl_JbJkLBL6rFZzK0zLEAAoHtea_i</code></p>
                        </div>
                        <div class="bg-green-50 p-3 rounded-lg">
                            <h4 class="font-semibold text-green-800 mb-2">2. Deploy Google Apps Script</h4>
                            <p class="text-green-700 text-xs">• Buka script.google.com dan buat project baru</p>
                            <p class="text-green-700 text-xs">• Copy script code yang sudah disediakan</p>
                            <p class="text-green-700 text-xs">• Deploy sebagai Web App dengan akses "Anyone"</p>
                        </div>
                        <div class="bg-orange-50 p-3 rounded-lg">
                            <h4 class="font-semibold text-orange-800 mb-2">3. Update URL di Aplikasi</h4>
                            <p class="text-orange-700 text-xs">• Copy URL deployment dari Apps Script</p>
                            <p class="text-orange-700 text-xs">• Ganti <code>YOUR_DEPLOYMENT_ID</code> dengan URL yang benar</p>
                            <p class="text-orange-700 text-xs">• Test form untuk memastikan data masuk ke Sheets</p>
                        </div>
                        <div class="bg-purple-50 p-3 rounded-lg">
                            <h4 class="font-semibold text-purple-800 mb-2">4. Fitur yang Didukung</h4>
                            <p class="text-purple-700 text-xs">• ✅ Auto-timestamp dengan zona waktu Indonesia</p>
                            <p class="text-purple-700 text-xs">• ✅ Upload file PDF/gambar ke Google Drive</p>
                            <p class="text-purple-700 text-xs">• ✅ Data tersimpan sesuai urutan kolom yang benar</p>
                            <p class="text-purple-700 text-xs">• ✅ Auto-format header dan resize kolom</p>
                        </div>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="mt-4 bg-primary text-white px-4 py-2 rounded-lg">
                        Tutup
                    </button>
                </div>
            `;
            document.body.appendChild(instructionsDiv);
        }

        // Send data to Google Sheets
        async function sendToGoogleSheets(data) {
            try {
                console.log('📤 Mengirim data ke Google Sheets...');
                
                // Google Apps Script Web App URL - Connected to AplikasiWalangaduk Database
                const scriptUrl = 'https://script.google.com/macros/s/AKfycbwAJIYm9HjUw1K3tphlUx-zy6x97hOfT1uMqlKzupBptXdxaJPHBGoEb1ilvhTH4BNJDA/exec';
                
                // Prepare data for Google Sheets sesuai urutan tabel dan Apps Script
                const sheetData = {
                    tanggal: data.tanggal,
                    jenipelaporan: data.jenipelaporan,
                    namapetugas: data.namapetugas,
                    nip: data.nip,
                    namainstansi: data.namainstansi,
                    telp: data.telp,
                    email: data.email,
                    namalengkap: data.namalengkap,
                    tempatlahir: data.tempatlahir,
                    tanggallahir: data.tanggallahir,
                    jeniskelamin: data.jeniskelamin,
                    namaibu: data.namaibu,
                    namaayah: data.namaayah,
                    kecamatan: data.kecamatan,
                    desakelurahan: data.desakelurahan,
                    rtrw: data.rtrw,
                    syaratdanketentuan: data.syaratdanketentuan,
                    unggahberkas: uploadedFiles.length > 0 ? JSON.stringify(uploadedFiles) : ''
                };
                
                console.log('📋 Data yang akan dikirim:', sheetData);
                
                // Method 1: Try direct POST to Google Apps Script
                try {
                    const response = await fetch(scriptUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: new URLSearchParams(sheetData).toString(),
                        mode: 'cors'
                    });
                    
                    if (response.ok) {
                        const result = await response.text();
                        console.log('✅ Response dari Google Sheets:', result);
                        
                        // Parse response to check success
                        try {
                            const jsonResult = JSON.parse(result);
                            if (jsonResult.success) {
                                return true;
                            } else {
                                throw new Error(jsonResult.message || 'Unknown error from server');
                            }
                        } catch (parseError) {
                            // If not JSON, assume success if response is OK
                            return true;
                        }
                    } else {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                } catch (fetchError) {
                    console.warn('⚠️ Method 1 gagal:', fetchError.message);
                }
                
                // Method 2: Try with no-cors mode (fallback)
                try {
                    await fetch(scriptUrl, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                        },
                        body: new URLSearchParams(sheetData).toString()
                    });
                    
                    console.log('✅ Data dikirim dengan mode no-cors');
                    return true;
                } catch (noCorsError) {
                    console.warn('⚠️ Method 2 gagal:', noCorsError.message);
                }
                
                // Method 3: Form submission method
                try {
                    console.log('🔄 Mencoba metode form submission...');
                    
                    const form = document.createElement('form');
                    form.method = 'POST';
                    form.action = scriptUrl;
                    form.target = 'hidden_iframe';
                    form.style.display = 'none';
                    
                    // Create hidden iframe for form submission
                    const iframe = document.createElement('iframe');
                    iframe.name = 'hidden_iframe';
                    iframe.style.display = 'none';
                    document.body.appendChild(iframe);
                    
                    // Add form fields
                    Object.entries(sheetData).forEach(([key, value]) => {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = key;
                        input.value = typeof value === 'object' ? JSON.stringify(value) : String(value);
                        form.appendChild(input);
                    });
                    
                    document.body.appendChild(form);
                    
                    // Submit form and clean up
                    return new Promise((resolve) => {
                        iframe.onload = () => {
                            console.log('✅ Form berhasil disubmit ke Google Sheets');
                            document.body.removeChild(form);
                            document.body.removeChild(iframe);
                            resolve(true);
                        };
                        
                        form.submit();
                        
                        // Fallback timeout
                        setTimeout(() => {
                            console.log('✅ Form submission timeout - assuming success');
                            if (document.body.contains(form)) document.body.removeChild(form);
                            if (document.body.contains(iframe)) document.body.removeChild(iframe);
                            resolve(true);
                        }, 5000);
                    });
                    
                } catch (formError) {
                    console.error('❌ Method 3 gagal:', formError.message);
                    throw new Error('Semua metode pengiriman gagal');
                }
                
            } catch (error) {
                console.error('❌ Error mengirim ke Google Sheets:', error);
                throw error;
            }
        }

        // Initialize registration form
        function initializeRegistrationForm() {
            const registrationForm = document.getElementById('registrationForm');
            if (registrationForm) {
                registrationForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.textContent;
                    
                    try {
                        // Validate form
                        const formData = new FormData(this);
                        const data = Object.fromEntries(formData.entries());
                        
                        // Check required fields
                        const requiredFields = ['tanggal', 'namapetugas', 'nip', 'telp', 'email', 'namainstansi', 'jenipelaporan', 'namalengkap', 'tempatlahir', 'tanggallahir', 'jeniskelamin', 'namaibu', 'namaayah', 'kecamatan', 'desakelurahan', 'rtrw'];
                        
                        for (const field of requiredFields) {
                            if (!data[field] || data[field].trim() === '') {
                                alert(`❌ Field "${field}" harus diisi!`);
                                return;
                            }
                        }
                        
                        if (!data.syaratdanketentuan) {
                            alert('❌ Anda harus menyetujui syarat dan ketentuan!');
                            return;
                        }
                        
                        // Prepare data with proper file handling
                        data.syaratdanketentuan = data.syaratdanketentuan ? 'Ya' : 'Tidak';
                        
                        data.timestamp = new Date().toLocaleString('id-ID', {
                            timeZone: 'Asia/Jayapura',
                            year: 'numeric',
                            month: '2-digit',
                            day: '2-digit',
                            hour: '2-digit',
                            minute: '2-digit',
                            second: '2-digit'
                        });
                        
                        // Send to Google Sheets
                        submitBtn.textContent = 'Mengirim Data ke Database...';
                        submitBtn.disabled = true;
                        
                        console.log('📤 Memulai proses pengiriman data...');
                        
                        try {
                            await sendToGoogleSheets(data);
                            console.log('✅ Data berhasil disimpan ke Google Sheets');
                            
                            // Show success message
                            const successDiv = document.createElement('div');
                            successDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-8 py-6 rounded-xl shadow-2xl z-50 text-center';
                            successDiv.innerHTML = `
                                <div class="text-4xl mb-4">✅</div>
                                <h3 class="text-xl font-bold mb-2">Data Berhasil Dikirim!</h3>
                                <p class="text-sm opacity-90">Data registrasi telah tersimpan ke database AplikasiWalangaduk</p>
                            `;
                            document.body.appendChild(successDiv);
                            
                            // Auto close success message
                            setTimeout(() => {
                                successDiv.remove();
                            }, 4000);
                            
                            // Reset form after successful submission
                            setTimeout(() => {
                                this.reset();
                                document.getElementById('fileList').innerHTML = '';
                                document.getElementById('desa').innerHTML = '<option value="">Pilih Desa</option>';
                                uploadedFiles = [];
                                
                                // Set today's date
                                const today = new Date().toISOString().split('T')[0];
                                const dateInput = this.querySelector('input[name="tanggal"]');
                                if (dateInput) {
                                    dateInput.value = today;
                                }
                            }, 2000);
                            
                        } catch (sheetError) {
                            console.error('❌ Gagal menyimpan ke Google Sheets:', sheetError);
                            
                            // Show error message
                            const errorDiv = document.createElement('div');
                            errorDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white px-8 py-6 rounded-xl shadow-2xl z-50 text-center';
                            errorDiv.innerHTML = `
                                <div class="text-4xl mb-4">❌</div>
                                <h3 class="text-xl font-bold mb-2">Gagal Mengirim Data</h3>
                                <p class="text-sm opacity-90 mb-4">Terjadi kesalahan saat mengirim ke Google Sheets</p>
                                <p class="text-xs opacity-75">Pastikan URL Google Apps Script sudah benar</p>
                            `;
                            document.body.appendChild(errorDiv);
                            
                            setTimeout(() => {
                                errorDiv.remove();
                            }, 5000);
                            
                            throw sheetError;
                        }
                        
                    } catch (error) {
                        console.error('❌ Error in form submission:', error);
                        
                        if (!document.querySelector('.fixed.bg-red-500')) {
                            alert('❌ Terjadi kesalahan saat memproses data. Silakan coba lagi.\n\nDetail: ' + error.message);
                        }
                    } finally {
                        setTimeout(() => {
                            submitBtn.textContent = originalText;
                            submitBtn.disabled = false;
                        }, 2000);
                    }
                });
            }
        }

        // Load dashboard data from Google Sheets
        async function loadDashboardData() {
            try {
                document.getElementById('serviceStats').innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="relative">
                            <div class="animate-spin rounded-full h-12 w-12 border-4 border-primary border-t-transparent mx-auto mb-4"></div>
                        </div>
                        <p class="text-gray-500 font-medium">Memuat data real-time dari Google Sheets...</p>
                        <p class="text-xs text-gray-400 mt-2">Mengakses: AplikasiWalangaduk Database</p>
                    </div>
                `;

                // Real Google Sheets CSV URL - Updated to your provided link
                const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR2ueJ9t2S1OgTczcbWyXKWqhgpzqI0Yc_kC2w8A1xYB2gtlg00tl38jmBFWcVt-gGiKJclocbCcTDl/pub?gid=1679940899&single=true&output=csv';
                
                console.log('🔗 Mengakses Google Sheets:', csvUrl);
                
                // Multiple CORS proxy options for better reliability
                const proxyUrls = [
                    'https://api.allorigins.win/get?url=' + encodeURIComponent(csvUrl),
                    'https://corsproxy.io/?' + encodeURIComponent(csvUrl),
                    'https://cors-anywhere.herokuapp.com/' + csvUrl
                ];
                
                let csvText = null;
                let lastError = null;
                
                // Try each proxy until one works
                for (const proxyUrl of proxyUrls) {
                    try {
                        console.log('🔄 Mencoba proxy:', proxyUrl);
                        const response = await fetch(proxyUrl, {
                            method: 'GET',
                            headers: {
                                'Accept': 'application/json, text/plain, */*',
                                'Content-Type': 'application/json'
                            }
                        });
                        
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                        }
                        
                        const data = await response.json();
                        csvText = data.contents || data.data || data;
                        
                        if (typeof csvText === 'string' && csvText.length > 0) {
                            console.log('✅ Berhasil mengakses data via proxy');
                            break;
                        }
                    } catch (error) {
                        console.warn('⚠️ Proxy gagal:', error.message);
                        lastError = error;
                        continue;
                    }
                }
                
                // If all proxies failed, try direct access
                if (!csvText) {
                    try {
                        console.log('🔄 Mencoba akses langsung ke Google Sheets...');
                        const directResponse = await fetch(csvUrl, {
                            method: 'GET',
                            mode: 'cors',
                            headers: {
                                'Accept': 'text/csv, text/plain, */*'
                            }
                        });
                        
                        if (directResponse.ok) {
                            csvText = await directResponse.text();
                            console.log('✅ Berhasil akses langsung');
                        }
                    } catch (directError) {
                        console.warn('⚠️ Akses langsung gagal:', directError.message);
                    }
                }
                
                // If still no data, show error message without dummy data
                if (!csvText || csvText.length === 0) {
                    console.log('❌ Semua metode akses gagal');
                    
                    // Show error message without dummy data
                    const errorDiv = document.createElement('div');
                    errorDiv.className = 'col-span-full bg-red-50 border border-red-200 rounded-lg p-6';
                    errorDiv.innerHTML = `
                        <div class="text-center">
                            <div class="text-red-500 text-4xl mb-4">📊</div>
                            <h4 class="text-red-800 font-semibold text-lg mb-2">Tidak Dapat Mengakses Data</h4>
                            <p class="text-red-700 text-sm mb-4">Gagal terhubung ke Google Sheets AplikasiWalangaduk</p>
                            <p class="text-red-600 text-xs mb-4">Pastikan Google Sheets dapat diakses secara publik</p>
                            <button onclick="loadDashboardData()" class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-600 transition-colors">
                                🔄 Coba Lagi
                            </button>
                        </div>
                    `;
                    
                    document.getElementById('serviceStats').innerHTML = '';
                    document.getElementById('serviceStats').appendChild(errorDiv);
                    document.getElementById('lastUpdate').textContent = 'Gagal memuat data - ' + new Date().toLocaleString('id-ID');
                    return;
                }
                
                // Parse CSV data
                console.log('📊 Memproses data CSV...');
                const lines = csvText.replace(/\r\n/g, '\n').replace(/\r/g, '\n').trim().split('\n');
                console.log(`📄 CSV memiliki ${lines.length} baris`);
                
                if (lines.length < 2) {
                    throw new Error('Data CSV tidak memiliki cukup baris');
                }
                
                // Enhanced CSV parser
                function parseCSVLine(line) {
                    const result = [];
                    let current = '';
                    let inQuotes = false;
                    
                    for (let i = 0; i < line.length; i++) {
                        const char = line[i];
                        
                        if (char === '"') {
                            inQuotes = !inQuotes;
                        } else if (char === ',' && !inQuotes) {
                            result.push(current.trim().replace(/^"|"$/g, ''));
                            current = '';
                        } else {
                            current += char;
                        }
                    }
                    result.push(current.trim().replace(/^"|"$/g, ''));
                    return result;
                }
                
                const headers = parseCSVLine(lines[0]).map(h => h.toLowerCase().trim());
                console.log('📋 Headers CSV:', headers);
                
                // Process data and count services
                const serviceStats = {};
                const kecamatanStats = {};
                let validRows = 0;
                
                // Initialize service counters
                Object.keys(serviceNames).forEach(service => {
                    serviceStats[service] = 0;
                });
                
                // Process each data row
                for (let i = 1; i < lines.length; i++) {
                    try {
                        const row = parseCSVLine(lines[i]);
                        
                        if (row.length < 2 || !row.some(cell => cell.trim())) {
                            continue; // Skip empty rows
                        }
                        
                        const rowData = {};
                        headers.forEach((header, index) => {
                            rowData[header] = (row[index] || '').trim();
                        });
                        
                        // Get service type and kecamatan
                        const jenisLayanan = rowData['jenipelaporan'] || rowData['jenis pelaporan'] || rowData['layanan'] || '';
                        const kecamatan = rowData['kecamatan'] || '';
                        
                        if (jenisLayanan && serviceStats.hasOwnProperty(jenisLayanan)) {
                            serviceStats[jenisLayanan]++;
                            validRows++;
                            
                            // Count by kecamatan
                            if (kecamatan) {
                                if (!kecamatanStats[kecamatan]) {
                                    kecamatanStats[kecamatan] = {};
                                    Object.keys(serviceNames).forEach(service => {
                                        kecamatanStats[kecamatan][service] = 0;
                                    });
                                }
                                kecamatanStats[kecamatan][jenisLayanan]++;
                            }
                        }
                        
                    } catch (rowError) {
                        console.warn(`⚠️ Error memproses baris ${i}:`, rowError);
                        continue;
                    }
                }
                
                console.log(`✅ Berhasil memproses ${validRows} data dari ${lines.length - 1} baris`);
                console.log('📊 Statistik layanan:', serviceStats);
                console.log('🗺️ Statistik per kecamatan:', kecamatanStats);
                
                // Display the processed data
                displayServiceStats(serviceStats, kecamatanStats);
                
                document.getElementById('lastUpdate').textContent = 'Terakhir diperbarui: ' + new Date().toLocaleString('id-ID');
                
            } catch (error) {
                console.error('❌ Error loading dashboard data:', error);
                
                // Show error without dummy data
                const errorDiv = document.createElement('div');
                errorDiv.className = 'col-span-full bg-red-50 border border-red-200 rounded-lg p-6';
                errorDiv.innerHTML = `
                    <div class="text-center">
                        <div class="text-red-500 text-4xl mb-4">⚠️</div>
                        <h4 class="text-red-800 font-semibold text-lg mb-2">Terjadi Kesalahan</h4>
                        <p class="text-red-700 text-sm mb-2">Gagal memproses data dari Google Sheets</p>
                        <p class="text-red-600 text-xs mb-4">Error: ${error.message}</p>
                        <button onclick="loadDashboardData()" class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm hover:bg-red-600 transition-colors">
                            🔄 Coba Lagi
                        </button>
                    </div>
                `;
                
                document.getElementById('serviceStats').innerHTML = '';
                document.getElementById('serviceStats').appendChild(errorDiv);
                
                document.getElementById('lastUpdate').textContent = 'Error - ' + new Date().toLocaleString('id-ID');
            }
        }

        // Display service statistics
        function displayServiceStats(serviceStats, kecamatanStats) {
            const serviceStatsContainer = document.getElementById('serviceStats');
            
            // Calculate total
            const totalServices = Object.values(serviceStats).reduce((sum, count) => sum + count, 0);
            
            // Create service cards
            let statsHTML = '';
            
            Object.entries(serviceStats).forEach(([serviceType, count]) => {
                const icon = serviceIcons[serviceType] || '📄';
                const name = serviceNames[serviceType] || serviceType;
                const percentage = totalServices > 0 ? ((count / totalServices) * 100).toFixed(1) : 0;
                
                statsHTML += `
                    <div class="bg-white rounded-xl card-shadow p-4 sm:p-6 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
                        <div class="flex items-center justify-between mb-3">
                            <div class="text-2xl sm:text-3xl">${icon}</div>
                            <div class="text-right">
                                <div class="text-2xl sm:text-3xl font-bold text-primary">${count}</div>
                                <div class="text-xs text-gray-500">${percentage}%</div>
                            </div>
                        </div>
                        <h4 class="text-sm sm:text-base font-semibold text-gray-800 mb-1">${name}</h4>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="bg-gradient-to-r from-primary to-blue-600 h-2 rounded-full transition-all duration-500" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                `;
            });
            
            // Add total card
            statsHTML += `
                <div class="bg-gradient-to-br from-primary to-blue-600 text-white rounded-xl card-shadow p-4 sm:p-6 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
                    <div class="flex items-center justify-between mb-3">
                        <div class="text-2xl sm:text-3xl">📊</div>
                        <div class="text-right">
                            <div class="text-2xl sm:text-3xl font-bold">${totalServices}</div>
                            <div class="text-xs opacity-80">100%</div>
                        </div>
                    </div>
                    <h4 class="text-sm sm:text-base font-semibold mb-1">Total Layanan</h4>
                    <div class="w-full bg-white/20 rounded-full h-2">
                        <div class="bg-white h-2 rounded-full" style="width: 100%"></div>
                    </div>
                </div>
            `;
            
            serviceStatsContainer.innerHTML = statsHTML;
            
            // Update chart
            updateServiceChart(kecamatanStats);
        }

        // Update service chart
        function updateServiceChart(kecamatanStats) {
            const ctx = document.getElementById('serviceChart');
            if (!ctx) return;
            
            // Destroy existing chart
            if (serviceChart) {
                serviceChart.destroy();
            }
            
            // Prepare chart data - Calculate total services per kecamatan
            const kecamatanNames = Object.keys(kecamatanStats);
            const totalData = kecamatanNames.map(kecamatan => {
                if (!kecamatanStats[kecamatan]) return 0;
                return Object.values(kecamatanStats[kecamatan]).reduce((sum, count) => sum + count, 0);
            });
            
            // Create gradient colors for bars
            const gradientColors = [
                '#31326F', '#4A4B8C', '#6366F1', '#8B5CF6', 
                '#A855F7', '#C084FC', '#E879F9', '#F0ABFC'
            ];
            
            // Create horizontal bar chart with total services only
            serviceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: kecamatanNames,
                    datasets: [{
                        label: 'Total Layanan',
                        data: totalData,
                        backgroundColor: kecamatanNames.map((_, index) => gradientColors[index % gradientColors.length]),
                        borderColor: kecamatanNames.map((_, index) => gradientColors[index % gradientColors.length]),
                        borderWidth: 2,
                        borderRadius: 8,
                        borderSkipped: false,
                        hoverBackgroundColor: kecamatanNames.map((_, index) => gradientColors[index % gradientColors.length] + 'CC'),
                        hoverBorderWidth: 3
                    }]
                },
                options: {
                    indexAxis: 'y', // This makes it horizontal
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: '📊 Total Layanan Per Kecamatan (Klik untuk Detail)',
                            font: {
                                size: 18,
                                weight: 'bold'
                            },
                            color: '#31326F',
                            padding: 20
                        },
                        legend: {
                            display: false // Hide legend since we only have one dataset
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            borderColor: '#31326F',
                            borderWidth: 2,
                            cornerRadius: 12,
                            displayColors: false,
                            titleFont: {
                                size: 16,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14
                            },
                            padding: 12,
                            callbacks: {
                                title: function(context) {
                                    return `📍 ${context[0].label}`;
                                },
                                label: function(context) {
                                    return `📊 Total Layanan: ${context.parsed.x}`;
                                },
                                afterBody: function(context) {
                                    const kecamatan = context[0].label;
                                    if (kecamatanStats[kecamatan]) {
                                        let details = '\n📋 Rincian Layanan:';
                                        Object.entries(kecamatanStats[kecamatan]).forEach(([serviceType, count]) => {
                                            if (count > 0) {
                                                const icon = serviceIcons[serviceType] || '📄';
                                                const name = serviceNames[serviceType] || serviceType;
                                                details += `\n${icon} ${name}: ${count}`;
                                            }
                                        });
                                        details += '\n\n💡 Klik bar untuk melihat detail lengkap';
                                        return details;
                                    }
                                    return '\n💡 Klik bar untuk melihat detail lengkap';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '📈 Jumlah Total Layanan',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#31326F'
                            },
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1,
                                font: {
                                    size: 12
                                },
                                color: '#6B7280'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)',
                                lineWidth: 1
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '🏝️ Kecamatan',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                color: '#31326F'
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                color: '#374151',
                                padding: 10
                            },
                            grid: {
                                display: false
                            }
                        }
                    },
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    animation: {
                        duration: 1500,
                        easing: 'easeInOutQuart'
                    },
                    layout: {
                        padding: {
                            top: 10,
                            right: 40,
                            bottom: 10,
                            left: 10
                        }
                    },
                    onClick: function(event, elements) {
                        if (elements.length > 0) {
                            const elementIndex = elements[0].index;
                            const kecamatan = kecamatanNames[elementIndex];
                            showKecamatanDetail(kecamatan, kecamatanStats[kecamatan]);
                        }
                    },
                    onHover: function(event, elements) {
                        event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                    }
                },
                plugins: [{
                    id: 'customDataLabels',
                    afterDatasetsDraw: function(chart) {
                        const ctx = chart.ctx;
                        const dataset = chart.data.datasets[0];
                        const meta = chart.getDatasetMeta(0);
                        
                        meta.data.forEach((bar, index) => {
                            const value = dataset.data[index];
                            if (value > 0) {
                                ctx.fillStyle = '#374151';
                                ctx.font = 'bold 12px Arial';
                                ctx.textAlign = 'left';
                                ctx.textBaseline = 'middle';
                                
                                const x = bar.x + 10;
                                const y = bar.y;
                                
                                ctx.fillText(value, x, y);
                            }
                        });
                    }
                }]
            });
        }

        // Show detailed breakdown when clicking on a kecamatan bar
        function showKecamatanDetail(kecamatan, serviceData) {
            if (!serviceData) return;
            
            // Calculate total for this kecamatan
            const total = Object.values(serviceData).reduce((sum, count) => sum + count, 0);
            
            // Create detailed breakdown
            let detailHTML = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onclick="this.remove()">
                    <div class="bg-white rounded-2xl p-6 max-w-2xl max-h-96 overflow-y-auto shadow-2xl" onclick="event.stopPropagation()">
                        <div class="text-center mb-6">
                            <h3 class="text-2xl font-bold text-primary mb-2">📍 ${kecamatan}</h3>
                            <p class="text-gray-600">Rincian Layanan Administrasi Kependudukan</p>
                            <div class="bg-gradient-to-r from-primary to-blue-600 text-white rounded-lg p-4 mt-4">
                                <div class="text-3xl font-bold">${total}</div>
                                <div class="text-sm opacity-90">Total Layanan</div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
            `;
            
            // Add service breakdown cards
            Object.entries(serviceData).forEach(([serviceType, count]) => {
                if (count > 0) {
                    const icon = serviceIcons[serviceType] || '📄';
                    const name = serviceNames[serviceType] || serviceType;
                    const percentage = total > 0 ? ((count / total) * 100).toFixed(1) : 0;
                    
                    detailHTML += `
                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-2xl">${icon}</span>
                                <span class="text-xl font-bold text-primary">${count}</span>
                            </div>
                            <h4 class="font-semibold text-gray-800 text-sm mb-1">${name}</h4>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-primary to-blue-600 h-2 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                            <div class="text-xs text-gray-500 mt-1">${percentage}% dari total</div>
                        </div>
                    `;
                }
            });
            
            detailHTML += `
                        </div>
                        
                        <div class="text-center">
                            <button onclick="this.closest('.fixed').remove()" class="bg-primary text-white px-6 py-3 rounded-lg hover:bg-opacity-90 transition-all duration-300 font-medium">
                                ✅ Tutup Detail
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Add to DOM
            document.body.insertAdjacentHTML('beforeend', detailHTML);
        }

        // Update current date and time
        function updateDateTime() {
            const now = new Date();
            const options = {
                timeZone: 'Asia/Jayapura',
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            
            const dateTimeString = now.toLocaleDateString('id-ID', options) + ' WIT';
            document.getElementById('currentDateTime').textContent = dateTimeString;
        }



        // Initialize contact form with WhatsApp redirect
        function initializeContactForm() {
            const contactForm = document.getElementById('contactForm');
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const formData = new FormData(this);
                    const data = Object.fromEntries(formData.entries());
                    
                    // Validate WhatsApp number format
                    let whatsappNumber = data.whatsapp.trim();
                    
                    // Remove any non-digit characters
                    whatsappNumber = whatsappNumber.replace(/\D/g, '');
                    
                    // Add country code if not present
                    if (whatsappNumber.startsWith('0')) {
                        whatsappNumber = '62' + whatsappNumber.substring(1);
                    } else if (!whatsappNumber.startsWith('62')) {
                        whatsappNumber = '62' + whatsappNumber;
                    }
                    
                    // Validate number length (Indonesian phone numbers)
                    if (whatsappNumber.length < 10 || whatsappNumber.length > 15) {
                        alert('❌ Nomor WhatsApp tidak valid. Pastikan format nomor benar (contoh: 628123456789)');
                        return;
                    }
                    
                    // Create WhatsApp message
                    const message = `🌊 *Pesan dari Aplikasi Walangaduk*

👤 *Nama:* ${data.nama}
📧 *Email:* ${data.email}
📱 *WhatsApp:* ${data.whatsapp}

💬 *Pesan:*
${data.pesan}

---
Dikirim melalui Aplikasi Walangaduk
Dinas Kependudukan dan Pencatatan Sipil
Kabupaten Kepulauan Tanimbar`;
                    
                    // Encode message for URL
                    const encodedMessage = encodeURIComponent(message);
                    
                    // Create WhatsApp URL (using official WhatsApp number - you can change this)
                    const whatsappURL = `https://wa.me/6285344733576?text=${encodedMessage}`;
                    
                    // Show loading message
                    const loadingDiv = document.createElement('div');
                    loadingDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-8 py-6 rounded-xl shadow-2xl z-50 text-center';
                    loadingDiv.innerHTML = `
                        <div class="text-4xl mb-4">📱</div>
                        <h3 class="text-xl font-bold mb-2">Membuka WhatsApp...</h3>
                        <p class="text-sm opacity-90">Anda akan diarahkan ke WhatsApp dalam beberapa detik</p>
                        <div class="mt-4">
                            <div class="animate-spin rounded-full h-6 w-6 border-2 border-white border-t-transparent mx-auto"></div>
                        </div>
                    `;
                    document.body.appendChild(loadingDiv);
                    
                    // Open WhatsApp after short delay
                    setTimeout(() => {
                        window.open(whatsappURL, '_blank');
                        loadingDiv.remove();
                        
                        // Show success message
                        const successDiv = document.createElement('div');
                        successDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-green-500 text-white px-8 py-6 rounded-xl shadow-2xl z-50 text-center';
                        successDiv.innerHTML = `
                            <div class="text-4xl mb-4">✅</div>
                            <h3 class="text-xl font-bold mb-2">WhatsApp Terbuka!</h3>
                            <p class="text-sm opacity-90">Pesan Anda telah disiapkan di WhatsApp. Silakan kirim pesan tersebut.</p>
                        `;
                        document.body.appendChild(successDiv);
                        
                        setTimeout(() => {
                            successDiv.remove();
                        }, 4000);
                        
                        // Reset form
                        this.reset();
                    }, 2000);
                });
            }
        }

        // Initialize application
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Memulai aplikasi Walangaduk...');
            
            // Load login credentials first
            await loadLoginCredentials();
            
            // Check stored login state
            checkStoredLogin();
            
            // Set today's date in registration form
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.querySelector('input[name="tanggal"]');
            if (dateInput) {
                dateInput.value = today;
            }
            
            // Initialize all components
            initializeLoginForm();
            initializeRegistrationForm();
            initializeContactForm();
            
            // Update date/time every second
            updateDateTime();
            setInterval(updateDateTime, 1000);
            
            // Load dashboard data initially
            setTimeout(() => {
                loadDashboardData();
            }, 500);
            
            // Auto-refresh dashboard data every 5 minutes
            autoRefreshInterval = setInterval(() => {
                if (document.getElementById('dashboard').classList.contains('hidden') === false) {
                    loadDashboardData();
                }
            }, 300000); // 5 minutes
            
            // Auto-refresh login credentials every 10 minutes
            setInterval(() => {
                loadLoginCredentials();
            }, 600000); // 10 minutes
            
            console.log('✅ Aplikasi Walangaduk siap digunakan!');
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
            if (serviceChart) {
                serviceChart.destroy();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'980ef2761029ef70',t:'MTc1ODE3ODYyNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>


