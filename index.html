<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Walangaduk</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#31326F'
                    }
                }
            }
        }
    </script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #31326F 0%, #4A4B8C 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(49, 50, 111, 0.1);
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Hamburger Animation */
        .hamburger-active .hamburger-line:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .hamburger-active .hamburger-line:nth-child(2) {
            opacity: 0;
        }
        .hamburger-active .hamburger-line:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }
        
        /* Mobile menu slide animation */
        .mobile-menu-enter {
            animation: slideDown 0.3s ease-out;
        }
        .mobile-menu-exit {
            animation: slideUp 0.3s ease-in;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="gradient-bg text-white py-6 shadow-lg">
        <div class="container mx-auto px-4 text-center">
            <div class="flex flex-col items-center space-y-4">
                <img src="https://iili.io/KoUNepV.png" alt="Logo" class="h-24 w-24 md:h-32 md:w-32 lg:h-40 lg:w-40 object-contain">
                <div>
                    <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold mb-2 px-2">Aplikasi Walangaduk</h1>
                    <p class="text-sm sm:text-base md:text-lg lg:text-xl mb-2 px-4 max-w-4xl mx-auto">Layanan Registrasi Administrasi Kependudukan Secara Online Oleh Petugas Walangaduk di Desa</p>
                    <p class="text-xs sm:text-sm md:text-base lg:text-lg px-4 max-w-3xl mx-auto">Dinas Kependudukan dan Pencatatan Sipil Kabupaten Kepulauan Tanimbar</p>
                    <div class="mt-3 sm:mt-4 text-center">
                        <div id="currentDateTime" class="text-xs sm:text-sm md:text-base text-white/90 font-medium bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2 inline-block">
                            Loading...
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6">
            <div class="flex justify-between items-center py-3 sm:py-4">
                <div class="text-base sm:text-lg lg:text-xl font-semibold text-primary">
                    📱 Menu
                </div>
                
                <!-- Hamburger Button -->
                <button id="hamburger-btn" class="lg:hidden flex flex-col justify-center items-center w-10 h-10 space-y-1.5 focus:outline-none p-2 rounded-lg hover:bg-gray-100 transition-colors" onclick="toggleMenu()">
                    <span class="hamburger-line w-6 h-0.5 bg-primary transition-all duration-300"></span>
                    <span class="hamburger-line w-6 h-0.5 bg-primary transition-all duration-300"></span>
                    <span class="hamburger-line w-6 h-0.5 bg-primary transition-all duration-300"></span>
                </button>
                
                <!-- Desktop Navigation -->
                <div class="hidden lg:flex items-center space-x-2 xl:space-x-6">
                    <button onclick="showPage('dashboard')" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 bg-primary text-white text-sm xl:text-base">Dashboard</button>
                    <button onclick="showPage('registrasi')" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 text-primary hover:bg-primary hover:text-white text-sm xl:text-base">Registrasi</button>
                    <button onclick="showPage('tentang')" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 text-primary hover:bg-primary hover:text-white text-sm xl:text-base">Tentang Kami</button>
                    <button onclick="showPage('kontak')" class="nav-btn px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 text-primary hover:bg-primary hover:text-white text-sm xl:text-base">Kontak Kami</button>
                    <button onclick="logout()" class="px-4 xl:px-6 py-2 xl:py-3 rounded-lg font-medium transition-all duration-300 bg-red-500 text-white hover:bg-red-600 text-sm xl:text-base">
                        <span class="mr-1">🚪</span>Logout
                    </button>
                </div>
            </div>
            
            <!-- Mobile Navigation Menu -->
            <div id="mobile-menu" class="lg:hidden hidden bg-white border-t border-gray-200 shadow-lg">
                <div class="py-2 space-y-1">
                    <button onclick="showPage('dashboard'); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 bg-primary text-white font-medium text-base">📊 Dashboard</button>
                    <button onclick="showPage('registrasi'); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 font-medium text-base">📝 Registrasi</button>
                    <button onclick="showPage('tentang'); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 font-medium text-base">ℹ️ Tentang Kami</button>
                    <button onclick="showPage('kontak'); toggleMenu()" class="nav-btn-mobile w-full text-left px-4 py-4 text-primary hover:bg-primary hover:text-white transition-all duration-300 font-medium text-base">📞 Kontak Kami</button>
                    <div class="border-t border-gray-200 mt-2 pt-2">
                        <button onclick="logout(); toggleMenu()" class="w-full text-left px-4 py-4 bg-red-500 text-white hover:bg-red-600 transition-all duration-300 font-medium text-base">
                            🚪 Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Dashboard Page -->
    <div id="dashboard" class="page-content">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 xl:px-8 py-6 sm:py-8 md:py-10 lg:py-12">
            <!-- Welcome Hero Section -->
            <div class="text-center mb-8 sm:mb-12 md:mb-16">
                <div class="bg-gradient-to-br from-primary via-blue-600 to-purple-700 text-white rounded-3xl p-8 sm:p-12 md:p-16 shadow-2xl">
                    <div class="max-w-4xl mx-auto">
                        <h2 class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold mb-4 sm:mb-6">
                            🌊 Selamat Datang di Era Digital Kepulauan Tanimbar
                        </h2>
                        <p class="text-lg sm:text-xl md:text-2xl mb-6 sm:mb-8 opacity-90 leading-relaxed">
                            Menghubungkan setiap pulau, melayani setiap keluarga dengan teknologi modern yang mudah diakses
                        </p>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6 mt-8">
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6">
                                <div class="text-3xl sm:text-4xl mb-2">🏝️</div>
                                <h4 class="font-semibold text-lg mb-2">10 Kecamatan</h4>
                                <p class="text-sm opacity-80">Tersebar di Kepulauan Tanimbar</p>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6">
                                <div class="text-3xl sm:text-4xl mb-2">🏘️</div>
                                <h4 class="font-semibold text-lg mb-2">82+ Desa</h4>
                                <p class="text-sm opacity-80">Terjangkau layanan digital</p>
                            </div>
                            <div class="bg-white/10 backdrop-blur-sm rounded-xl p-4 sm:p-6">
                                <div class="text-3xl sm:text-4xl mb-2">👥</div>
                                <h4 class="font-semibold text-lg mb-2">Banyaknya Keluarga</h4>
                                <p class="text-sm opacity-80">Telah merasakan kemudahan</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Services Overview -->
            <div class="mb-8 sm:mb-12 md:mb-16">
                <div class="text-center mb-8 sm:mb-12">
                    <h3 class="text-2xl sm:text-3xl md:text-4xl font-bold text-primary mb-4">
                        🎯 Layanan Unggulan Kami
                    </h3>
                    <p class="text-gray-600 text-lg sm:text-xl max-w-3xl mx-auto leading-relaxed">
                        Solusi lengkap administrasi kependudukan yang dirancang khusus untuk masyarakat kepulauan
                    </p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8">
                    <!-- Service Card 1 -->
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-6 sm:p-8 border border-blue-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">👨‍👩‍👧‍👦</span>
                        </div>
                        <h4 class="text-xl font-bold text-blue-700 mb-3">Kartu Keluarga</h4>
                        <p class="text-blue-600 text-sm leading-relaxed">Pembuatan dan pembaruan Kartu Keluarga dengan proses yang cepat dan mudah, langsung dari desa Anda.</p>
                    </div>

                    <!-- Service Card 2 -->
                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-6 sm:p-8 border border-green-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">🆔</span>
                        </div>
                        <h4 class="text-xl font-bold text-green-700 mb-3">KTP Elektronik</h4>
                        <p class="text-green-600 text-sm leading-relaxed">Layanan pembuatan e-KTP dengan teknologi terdepan, memastikan identitas Anda terlindungi dan valid.</p>
                    </div>

                    <!-- Service Card 3 -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl p-6 sm:p-8 border border-purple-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">👶</span>
                        </div>
                        <h4 class="text-xl font-bold text-purple-700 mb-3">Kartu Identitas Anak</h4>
                        <p class="text-purple-600 text-sm leading-relaxed">Memberikan identitas resmi untuk anak-anak, melindungi hak dan masa depan generasi penerus bangsa.</p>
                    </div>

                    <!-- Service Card 4 -->
                    <div class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl p-6 sm:p-8 border border-orange-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">🍼</span>
                        </div>
                        <h4 class="text-xl font-bold text-orange-700 mb-3">Akta Kelahiran</h4>
                        <p class="text-orange-600 text-sm leading-relaxed">Pencatatan kelahiran yang sah dan legal, memberikan kepastian hukum sejak hari pertama kehidupan.</p>
                    </div>

                    <!-- Service Card 5 -->
                    <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-2xl p-6 sm:p-8 border border-red-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">📤</span>
                        </div>
                        <h4 class="text-xl font-bold text-red-700 mb-3">Surat Pindah & Datang</h4>
                        <p class="text-red-600 text-sm leading-relaxed">Layanan perpindahan penduduk antar wilayah dengan proses yang transparan dan terpercaya.</p>
                    </div>

                    <!-- Service Card 6 -->
                    <div class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-2xl p-6 sm:p-8 border border-indigo-200 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                        <div class="w-16 h-16 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">⚰️</span>
                        </div>
                        <h4 class="text-xl font-bold text-indigo-700 mb-3">Akta Kematian</h4>
                        <p class="text-indigo-600 text-sm leading-relaxed">Pencatatan kematian yang menghormati dan memberikan kepastian hukum bagi keluarga yang ditinggalkan.</p>
                    </div>
                </div>
            </div>



            <!-- Why Choose Us -->
            <div class="mb-8 sm:mb-12 md:mb-16">
                <div class="text-center mb-8 sm:mb-12">
                    <h3 class="text-2xl sm:text-3xl md:text-4xl font-bold text-primary mb-4">
                        ✨ Mengapa Memilih Walangaduk?
                    </h3>
                    <p class="text-gray-600 text-lg sm:text-xl max-w-3xl mx-auto leading-relaxed">
                        Inovasi terdepan yang mengatasi tantangan geografis kepulauan dengan solusi teknologi modern
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 sm:gap-12">
                    <div class="space-y-6">
                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center flex-shrink-0">
                                <span class="text-white text-xl">🚀</span>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-gray-800 mb-2">Akses Mudah dari Mana Saja</h4>
                                <p class="text-gray-600 leading-relaxed">Tidak perlu lagi perjalanan jauh antar pulau. Layanan dapat diakses dari desa manapun di Kepulauan Tanimbar.</p>
                            </div>
                        </div>

                        <div class="flex items-start space-x-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center flex-shrink-0">
                                <span class="text-white text-xl">⚡</span>
                            </div>
                            <div>
                                <h4 class="text-xl font-bold text-gray-800 mb-2">Proses Cepat & Efisien</h4>
                                <p class="text-gray-600 leading-relaxed">Teknologi digital memungkinkan pemrosesan dokumen yang lebih cepat dengan tingkat akurasi tinggi.</p>
                            </div>
                        </div>


                    </div>

                    <div class="bg-gradient-to-br from-primary to-blue-600 rounded-2xl p-8 text-white">
                        <h4 class="text-2xl font-bold mb-6">📊 Dampak Positif Walangaduk</h4>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span>Waktu Pelayanan</span>
                                <span class="font-bold">↓ 75% Lebih Cepat</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-2">
                                <div class="bg-white h-2 rounded-full w-3/4"></div>
                            </div>

                            <div class="flex justify-between items-center">
                                <span>Biaya Transportasi</span>
                                <span class="font-bold">↓ 90% Hemat</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-2">
                                <div class="bg-white h-2 rounded-full w-9/10"></div>
                            </div>

                            <div class="flex justify-between items-center">
                                <span>Kepuasan Masyarakat</span>
                                <span class="font-bold">↑ 95% Puas</span>
                            </div>
                            <div class="w-full bg-white/20 rounded-full h-2">
                                <div class="bg-white h-2 rounded-full w-11/12"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>





    <!-- Registrasi Page -->
    <div id="registrasi" class="page-content hidden">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-3 sm:py-4 md:py-6 lg:py-8">
            <div class="max-w-xs sm:max-w-lg md:max-w-2xl lg:max-w-4xl xl:max-w-5xl mx-auto">

                
                <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-3 sm:p-4 md:p-6 lg:p-8">
                    <h2 class="text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-primary mb-4 sm:mb-6 lg:mb-8 text-center px-1 sm:px-2 leading-tight">Form Registrasi Administrasi Kependudukan</h2>
                    
                    <form id="registrationForm" class="space-y-4 sm:space-y-5 md:space-y-6">
                        <!-- Tanggal dan Jenis Pelaporan -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Informasi Pelaporan
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Tanggal</label>
                                    <input type="date" name="tanggal" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Jenis Pelaporan</label>
                                    <select name="jenipelaporan" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                        <option value="">Pilih Jenis Pelaporan</option>
                                        <option value="KK">Kartu Keluarga (KK)</option>
                                        <option value="KTP EL">KTP Elektronik</option>
                                        <option value="KIA">Kartu Identitas Anak</option>
                                        <option value="SKPWNI">Surat Keterangan Pindah WNI</option>
                                        <option value="SKDWNI">Surat Keterangan Datang WNI</option>
                                        <option value="Akta Kelahiran">Akta Kelahiran</option>
                                        <option value="Akta Kematian">Akta Kematian</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Data Petugas -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Data Petugas
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Petugas</label>
                                    <input type="text" name="namapetugas" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">NIP Petugas</label>
                                    <input type="text" name="nip" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Instansi</label>
                                    <input type="text" name="namainstansi" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">No Handphone</label>
                                    <input type="tel" name="telp" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Email</label>
                                    <input type="email" name="email" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                            </div>
                        </div>

                        <!-- Data Pemohon -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Data Pemohon
                            </h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4">
                                <div class="flex items-start space-x-2">
                                    <div class="text-blue-600 text-lg flex-shrink-0">ℹ️</div>
                                    <div>
                                        <h4 class="text-blue-800 font-semibold text-sm mb-1">Keterangan Data Pemohon:</h4>
                                        <p class="text-blue-700 text-xs sm:text-sm leading-relaxed">
                                            Data pemohon dapat berupa <strong>Pemohon</strong> (orang yang mengajukan permohonan), 
                                            <strong>Bayi/Anak</strong> (untuk pengurusan dokumen anak), atau 
                                            <strong>Jenazah</strong> (untuk pengurusan akta kematian).
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div class="md:col-span-2">
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Lengkap</label>
                                    <input type="text" name="namalengkap" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Tempat Lahir</label>
                                    <input type="text" name="tempatlahir" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Tanggal Lahir</label>
                                    <input type="date" name="tanggallahir" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Jenis Kelamin</label>
                                    <select name="jeniskelamin" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                        <option value="">Pilih Jenis Kelamin</option>
                                        <option value="Laki-laki">Laki-laki</option>
                                        <option value="Perempuan">Perempuan</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Ibu</label>
                                    <input type="text" name="namaibu" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Ayah</label>
                                    <input type="text" name="namaayah" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                            </div>
                        </div>

                        <!-- Alamat -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Alamat
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4">
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Kecamatan</label>
                                    <select name="kecamatan" id="kecamatan" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base" onchange="updateDesa()">
                                        <option value="">Pilih Kecamatan</option>
                                        <option value="Tanimbar Selatan">Tanimbar Selatan</option>
                                        <option value="Selaru">Selaru</option>
                                        <option value="Wertamrian">Wertamrian</option>
                                        <option value="Wermaktian">Wermaktian</option>
                                        <option value="Tanimbar Utara">Tanimbar Utara</option>
                                        <option value="Fordata">Fordata</option>
                                        <option value="Wuarlabobar">Wuarlabobar</option>
                                        <option value="Kormomolin">Kormomolin</option>
                                        <option value="Nirunmas">Nirunmas</option>
                                        <option value="Molumaru">Molumaru</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Desa</label>
                                    <select name="desakelurahan" id="desa" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                        <option value="">Pilih Desa</option>
                                    </select>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">RT/RW</label>
                                    <input type="text" name="rtrw" required placeholder="Contoh: RT 001/RW 002" class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                                </div>
                            </div>
                        </div>

                        <!-- Upload Berkas -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                Upload Berkas
                            </h3>
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3 sm:p-4 mb-4">
                                <div class="flex items-start space-x-2">
                                    <div class="text-yellow-600 text-lg flex-shrink-0">⚠️</div>
                                    <div>
                                        <h4 class="text-yellow-800 font-semibold text-sm mb-1">Catatan Penting:</h4>
                                        <p class="text-yellow-700 text-xs sm:text-sm leading-relaxed">
                                            Berkas yang di upload harus asli dalam bentuk PDF. Pastikan dokumen sudah dipindai dengan jelas dan dapat dibaca.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="border-2 border-dashed border-gray-300 rounded-md p-4 sm:p-6 text-center hover:border-primary transition-colors">
                                <input type="file" id="fileUpload" name="unggahberkas" multiple accept=".pdf,.jpg,.jpeg,.png" class="hidden" onchange="handleFileUpload(event)">
                                <label for="fileUpload" class="cursor-pointer block">
                                    <div class="text-gray-500">
                                        <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                            <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                        </svg>
                                        <p class="mt-2 text-sm sm:text-base font-medium">Klik untuk upload berkas</p>
                                        <p class="text-xs sm:text-sm mt-1">Format: PDF, JPG, PNG (Max 5MB)</p>
                                    </div>
                                </label>
                                <div id="fileList" class="mt-3 sm:mt-4 text-left"></div>
                            </div>
                        </div>

                        <!-- Verifikasi Biometrik -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                🔐 Verifikasi Biometrik
                            </h3>
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4">
                                <div class="flex items-start space-x-2">
                                    <div class="text-blue-600 text-lg flex-shrink-0">📷</div>
                                    <div>
                                        <h4 class="text-blue-800 font-semibold text-sm mb-1">Foto Wajah untuk Verifikasi:</h4>
                                        <p class="text-blue-700 text-xs sm:text-sm leading-relaxed">
                                            Ambil foto wajah Anda untuk verifikasi identitas. Pastikan wajah terlihat jelas dan pencahayaan cukup.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
                                <!-- Camera Section -->
                                <div class="space-y-4">
                                    <div class="bg-gray-100 rounded-lg overflow-hidden" style="aspect-ratio: 4/3;">
                                        <video id="cameraVideo" class="w-full h-full object-cover hidden" autoplay playsinline></video>
                                        <canvas id="cameraCanvas" class="w-full h-full object-cover hidden"></canvas>
                                        <div id="cameraPlaceholder" class="w-full h-full flex items-center justify-center bg-gray-200">
                                            <div class="text-center">
                                                <div class="text-4xl text-gray-400 mb-2">📷</div>
                                                <p class="text-gray-500 text-sm">Kamera belum aktif</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="flex flex-col sm:flex-row gap-2">
                                        <button type="button" id="startCameraBtn" onclick="startCamera()" class="flex-1 bg-blue-500 text-white px-4 py-3 rounded-lg font-medium hover:bg-blue-600 transition-colors flex items-center justify-center">
                                            <span class="mr-2">📹</span>
                                            Aktifkan Kamera
                                        </button>
                                        <button type="button" id="captureBtn" onclick="capturePhoto()" class="flex-1 bg-green-500 text-white px-4 py-3 rounded-lg font-medium hover:bg-green-600 transition-colors flex items-center justify-center hidden">
                                            <span class="mr-2">📸</span>
                                            Ambil Foto
                                        </button>
                                        <button type="button" id="retakeBtn" onclick="retakePhoto()" class="flex-1 bg-orange-500 text-white px-4 py-3 rounded-lg font-medium hover:bg-orange-600 transition-colors flex items-center justify-center hidden">
                                            <span class="mr-2">🔄</span>
                                            Foto Ulang
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Captured Photo Preview -->
                                <div class="space-y-4">
                                    <div class="bg-gray-100 rounded-lg overflow-hidden" style="aspect-ratio: 4/3;">
                                        <img id="capturedPhoto" class="w-full h-full object-cover hidden" alt="Foto yang diambil">
                                        <div id="photoPlaceholder" class="w-full h-full flex items-center justify-center bg-gray-200">
                                            <div class="text-center">
                                                <div class="text-4xl text-gray-400 mb-2">🖼️</div>
                                                <p class="text-gray-500 text-sm">Foto belum diambil</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div id="biometricStatus" class="hidden">
                                        <div class="bg-green-50 border border-green-200 rounded-lg p-3">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-green-600 text-lg">✅</span>
                                                <div>
                                                    <h4 class="text-green-800 font-semibold text-sm">Foto Berhasil Diambil</h4>
                                                    <p class="text-green-700 text-xs">Verifikasi biometrik siap untuk diproses</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- CAPTCHA Verification -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <h3 class="text-base sm:text-lg md:text-xl font-semibold text-primary mb-3 sm:mb-4 border-b border-gray-200 pb-2">
                                🛡️ Verifikasi CAPTCHA
                            </h3>
                            <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4 mb-4">
                                <div class="flex items-start space-x-2">
                                    <div class="text-orange-600 text-lg flex-shrink-0">🔒</div>
                                    <div>
                                        <h4 class="text-orange-800 font-semibold text-sm mb-1">Verifikasi Keamanan:</h4>
                                        <p class="text-orange-700 text-xs sm:text-sm leading-relaxed">
                                            Masukkan kode CAPTCHA di bawah ini untuk memverifikasi bahwa Anda bukan robot.
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex flex-col sm:flex-row items-center gap-4">
                                <!-- CAPTCHA Display -->
                                <div class="bg-gray-100 border-2 border-gray-300 rounded-lg p-4 flex-shrink-0">
                                    <canvas id="captchaCanvas" width="200" height="80" class="bg-white rounded border"></canvas>
                                </div>
                                
                                <!-- CAPTCHA Input and Controls -->
                                <div class="flex-1 space-y-3 w-full">
                                    <div>
                                        <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-2">Masukkan Kode CAPTCHA</label>
                                        <input type="text" id="captchaInput" name="captcha" required maxlength="6" class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base text-center font-mono text-lg tracking-widest" placeholder="Masukkan 6 karakter">
                                    </div>
                                    
                                    <div class="flex gap-2">
                                        <button type="button" onclick="generateCaptcha()" class="flex-1 bg-gray-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-600 transition-colors flex items-center justify-center text-sm">
                                            <span class="mr-2">🔄</span>
                                            Buat Ulang
                                        </button>
                                        <button type="button" onclick="verifyCaptcha()" class="flex-1 bg-blue-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-600 transition-colors flex items-center justify-center text-sm">
                                            <span class="mr-2">✓</span>
                                            Verifikasi
                                        </button>
                                    </div>
                                    
                                    <div id="captchaStatus" class="hidden">
                                        <!-- Status will be shown here -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Syarat dan Ketentuan -->
                        <div class="border border-gray-200 p-3 sm:p-4 md:p-5 lg:p-6 rounded-lg">
                            <div class="flex items-start space-x-3">
                                <input type="checkbox" id="syaratKetentuan" name="syaratdanketentuan" required class="mt-1 h-5 w-5 sm:h-6 sm:w-6 text-primary border-gray-300 rounded focus:ring-primary">
                                <label for="syaratKetentuan" class="text-xs sm:text-sm text-gray-700 leading-relaxed">
                                    Saya menyetujui <a href="#" class="text-primary underline font-medium">syarat dan ketentuan</a> yang berlaku dan menjamin kebenaran data yang saya berikan.
                                </label>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <div class="text-center pt-4 sm:pt-6 space-y-4">
                            <button type="submit" class="w-full sm:w-auto bg-primary text-white px-6 sm:px-8 lg:px-12 py-3 sm:py-4 rounded-md text-base sm:text-lg font-semibold hover:bg-opacity-90 transition-all duration-300 shadow-md">
                                Kirim Data Registrasi
                            </button>
                            
                            <div class="text-center">
                                <p class="text-xs text-gray-500 mt-2">
                                    🔗 Terhubung dengan database AplikasiWalangaduk
                                </p>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Tentang Kami Page -->
    <div id="tentang" class="page-content hidden">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 md:py-8 lg:py-12">
            <div class="max-w-xs sm:max-w-lg md:max-w-2xl lg:max-w-4xl mx-auto">
                <!-- Hero Section -->
                <div class="text-center mb-8 sm:mb-12">
                    <div class="bg-gradient-to-br from-primary via-blue-600 to-purple-700 text-white rounded-3xl p-8 sm:p-12 shadow-2xl">
                        <h2 class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold mb-4">
                            🌊 Tentang Walangaduk
                        </h2>
                        <p class="text-lg sm:text-xl opacity-90 max-w-2xl mx-auto leading-relaxed">
                            Menjembatani jarak, menghubungkan harapan - Inovasi digital untuk kepulauan yang lebih maju
                        </p>
                    </div>
                </div>

                <!-- Story Section -->
                <div class="bg-white rounded-2xl card-shadow p-6 sm:p-8 mb-8">
                    <h3 class="text-xl sm:text-2xl font-bold text-primary mb-6 flex items-center">
                        🏝️ Cerita Kami
                    </h3>
                    <div class="prose prose-gray max-w-none">
                        <p class="text-gray-700 leading-relaxed mb-4">
                            Di tengah hamparan laut biru Kepulauan Tanimbar, terdapat tantangan yang telah lama dihadapi masyarakat - <strong>jarak yang memisahkan</strong>. Untuk mengurus dokumen kependudukan, warga harus menempuh perjalanan laut yang panjang dan mahal.
                        </p>
                        <p class="text-gray-700 leading-relaxed mb-4">
                            <strong>Walangaduk</strong> lahir dari kepedulian dan inovasi Dinas Kependudukan dan Pencatatan Sipil Kabupaten Kepulauan Tanimbar. Kami percaya bahwa <em>setiap warga, di pulau manapun, berhak mendapatkan pelayanan yang mudah dan berkualitas</em>.
                        </p>
                        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded-r-lg">
                            <p class="text-blue-800 font-medium italic">
                                "Walangaduk bukan sekadar aplikasi - ini adalah jembatan digital yang menghubungkan setiap keluarga di kepulauan dengan layanan pemerintah yang mereka butuhkan."
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Vision Mission -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8 mb-8">
                    <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-6 sm:p-8 border border-blue-200">
                        <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">👁️</span>
                        </div>
                        <h4 class="text-xl font-bold text-blue-700 mb-4">Visi Kami</h4>
                        <p class="text-blue-600 leading-relaxed">
                            Mewujudkan Kepulauan Tanimbar sebagai daerah kepulauan terdepan dalam pelayanan administrasi kependudukan digital yang <strong>inklusif, inovatif, dan berkelanjutan</strong>.
                        </p>
                    </div>

                    <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-6 sm:p-8 border border-green-200">
                        <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center mb-4">
                            <span class="text-3xl text-white">🎯</span>
                        </div>
                        <h4 class="text-xl font-bold text-green-700 mb-4">Misi Kami</h4>
                        <ul class="text-green-600 space-y-2 text-sm leading-relaxed">
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">•</span>
                                Memberikan akses layanan kependudukan yang mudah dan terjangkau
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">•</span>
                                Meningkatkan kualitas hidup masyarakat kepulauan melalui teknologi
                            </li>
                            <li class="flex items-start">
                                <span class="text-green-500 mr-2">•</span>
                                Membangun sistem pelayanan yang transparan dan akuntabel
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Values Section -->
                <div class="bg-white rounded-2xl card-shadow p-6 sm:p-8 mb-8">
                    <h3 class="text-xl sm:text-2xl font-bold text-primary mb-6 text-center">
                        ⭐ Nilai-Nilai Kami
                    </h3>
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">🤝</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Kepedulian</h5>
                            <p class="text-xs text-gray-600">Mengutamakan kebutuhan masyarakat</p>
                        </div>
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">⚡</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Inovasi</h5>
                            <p class="text-xs text-gray-600">Terus berinovasi untuk kemajuan</p>
                        </div>
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">🎯</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Integritas</h5>
                            <p class="text-xs text-gray-600">Jujur dan dapat dipercaya</p>
                        </div>
                        <div class="text-center p-4">
                            <div class="w-12 h-12 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-3">
                                <span class="text-white text-xl">🌟</span>
                            </div>
                            <h5 class="font-semibold text-gray-800 mb-2">Keunggulan</h5>
                            <p class="text-xs text-gray-600">Memberikan yang terbaik</p>
                        </div>
                    </div>
                </div>

                <!-- Impact Section -->
                <div class="bg-gradient-to-r from-primary to-blue-600 rounded-2xl p-6 sm:p-8 text-white mb-8">
                    <h3 class="text-xl sm:text-2xl font-bold mb-6 text-center">
                        🚀 Dampak Positif Walangaduk
                    </h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="text-center">
                            <div class="text-3xl sm:text-4xl font-bold mb-2">10,000+</div>
                            <p class="text-sm opacity-90">Dokumen Telah Diproses</p>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl sm:text-4xl font-bold mb-2">82</div>
                            <p class="text-sm opacity-90">Desa Terjangkau</p>
                        </div>
                        <div class="text-center">
                            <div class="text-3xl sm:text-4xl font-bold mb-2">95%</div>
                            <p class="text-sm opacity-90">Tingkat Kepuasan</p>
                        </div>
                    </div>
                    <div class="mt-8 text-center">
                        <p class="text-lg opacity-90 italic">
                            "Bersama-sama membangun masa depan digital Kepulauan Tanimbar yang lebih cerah"
                        </p>
                    </div>
                </div>

                <!-- Location Map Section -->
                <div class="bg-white rounded-2xl card-shadow p-6 sm:p-8">
                    <h3 class="text-xl sm:text-2xl font-bold text-primary mb-6 text-center flex items-center justify-center">
                        🗺️ Lokasi Kantor Kami
                    </h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 sm:gap-8">
                        <!-- Map Embed -->
                        <div class="order-2 lg:order-1">
                            <div class="bg-gray-100 rounded-xl overflow-hidden shadow-lg h-64 sm:h-80 relative">
                                <iframe 
                                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3973.123456789!2d131.123456!3d-7.123456!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zN8KwMDcnMjQuNCJTIDEzMcKwMDcnMjQuNCJF!5e0!3m2!1sen!2sid!4v1234567890"
                                    width="100%" 
                                    height="100%" 
                                    style="border:0;" 
                                    allowfullscreen="" 
                                    loading="lazy" 
                                    referrerpolicy="no-referrer-when-downgrade"
                                    class="rounded-xl">
                                </iframe>
                                <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent pointer-events-none rounded-xl"></div>
                            </div>
                            <div class="mt-4 text-center">
                                <a href="https://maps.app.goo.gl/Vtd6ps9dDmWdvTn27" 
                                   target="_blank" 
                                   class="inline-flex items-center bg-primary text-white px-6 py-3 rounded-lg hover:bg-opacity-90 transition-all duration-300 font-medium shadow-md">
                                    <span class="mr-2">📍</span>
                                    Buka di Google Maps
                                </a>
                            </div>
                        </div>
                        
                        <!-- Location Info -->
                        <div class="order-1 lg:order-2">
                            <div class="space-y-4">
                                <div class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-lg">🏢</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-blue-800 mb-1">Alamat Lengkap</h4>
                                            <p class="text-blue-700 text-sm leading-relaxed">
                                                Dinas Kependudukan dan Pencatatan Sipil<br>
                                                Kabupaten Kepulauan Tanimbar<br>
                                                Jl. Ir. Soekarno-Saumlaki<br>
                                                Provinsi Maluku
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-green-50 border border-green-200 rounded-xl p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-10 h-10 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-lg">⏰</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-green-800 mb-1">Jam Operasional</h4>
                                            <div class="text-green-700 text-sm space-y-1">
                                                <p><strong>Senin - Jumat:</strong> 08:00 - 16:00 WIT</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-purple-50 border border-purple-200 rounded-xl p-4">
                                    <div class="flex items-start space-x-3">
                                        <div class="w-10 h-10 bg-purple-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-lg">🚗</span>
                                        </div>
                                        <div>
                                            <h4 class="font-semibold text-purple-800 mb-1">Akses Transportasi</h4>
                                            <p class="text-purple-700 text-sm leading-relaxed">
                                                Dapat diakses melalui transportasi darat dari pusat kota Saumlaki. 
                                                Tersedia area parkir untuk kendaraan roda dua dan roda empat.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Kontak Kami Page -->
    <div id="kontak" class="page-content hidden">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 py-4 sm:py-6 md:py-8 lg:py-12">
            <div class="max-w-xs sm:max-w-lg md:max-w-2xl lg:max-w-4xl mx-auto">
                <div class="text-center mb-6 sm:mb-8 md:mb-10 lg:mb-12">
                    <h2 class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold text-primary mb-2 sm:mb-4">📞 Kontak Kami</h2>
                    <p class="text-sm sm:text-base md:text-lg lg:text-xl text-gray-600 px-2">Hubungi kami untuk bantuan dan informasi lebih lanjut</p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 md:gap-8">
                    <!-- Contact Information -->
                    <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-4 sm:p-6 md:p-8">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-primary mb-4 sm:mb-6 flex items-center">
                            📋 Informasi Kontak
                        </h3>
                        
                        <div class="space-y-3 sm:space-y-4">


                            <div class="flex items-start space-x-3 sm:space-x-4">
                                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                                    <span class="text-white text-lg sm:text-xl">📞</span>
                                </div>
                                <div class="min-w-0 flex-1">
                                    <h4 class="text-sm sm:text-base font-semibold text-gray-800 mb-1">Telepon</h4>
                                    <p class="text-xs sm:text-sm text-gray-600">+62 xxx-xxxx-xxxx</p>
                                </div>
                            </div>

                            <div class="flex items-start space-x-3 sm:space-x-4">
                                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
                                    <span class="text-white text-lg sm:text-xl">✉️</span>
                                </div>
                                <div class="min-w-0 flex-1">
                                    <h4 class="text-sm sm:text-base font-semibold text-gray-800 mb-1">Email</h4>
                                    <p class="text-xs sm:text-sm text-gray-600">dukcapil@tanimbar.go.id</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Contact Form -->
                    <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-4 sm:p-6 md:p-8">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-primary mb-4 sm:mb-6 border-b border-gray-200 pb-2">
                            Kirim Pesan
                        </h3>
                        
                        <form id="contactForm" class="space-y-3 sm:space-y-4">
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Nama Lengkap</label>
                                <input type="text" name="nama" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                            </div>
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">No WhatsApp</label>
                                <input type="tel" name="whatsapp" required placeholder="Contoh: 628123456789" class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                            </div>
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Email</label>
                                <input type="email" name="email" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base">
                            </div>
                            <div>
                                <label class="block text-xs sm:text-sm font-medium text-gray-700 mb-1 sm:mb-2">Pesan</label>
                                <textarea name="pesan" rows="4" required class="w-full px-3 sm:px-4 py-3 sm:py-4 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary focus:border-transparent text-sm sm:text-base resize-none"></textarea>
                            </div>
                            <button type="submit" class="w-full bg-green-600 text-white py-3 sm:py-4 rounded-md text-sm sm:text-base font-semibold hover:bg-green-700 transition-all duration-300 shadow-md flex items-center justify-center">
                                <span class="mr-2">📱</span>
                                Kirim via WhatsApp
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Location Map Section -->
                <div class="mt-6 sm:mt-8">
                    <div class="bg-white rounded-lg sm:rounded-xl card-shadow p-4 sm:p-6 md:p-8">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold text-primary mb-4 sm:mb-6 text-center flex items-center justify-center">
                            🗺️ Lokasi Kantor
                        </h3>
                        
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
                            <!-- Map -->
                            <div class="lg:col-span-2">
                                <div class="bg-gray-100 rounded-xl overflow-hidden shadow-lg h-64 sm:h-80 lg:h-96 relative">
                                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3951.369563117679!2d131.31245987358335!3d-7.960706379329434!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2d2755c0292f2a65%3A0x97d389f87f0d32!2sDinas%20Kependudukan%20dan%20Catatan%20Sipil%20Kabupaten%20Tanimbar!5e0!3m2!1sid!2sid!4v1759738301064!5m2!1sid!2sid" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                                    <div class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent pointer-events-none rounded-xl"></div>
                                </div>
                                <div class="mt-4 text-center">
                                    <a href="https://maps.app.goo.gl/Vtd6ps9dDmWdvTn27" 
                                       target="_blank" 
                                       class="inline-flex items-center bg-primary text-white px-4 sm:px-6 py-2 sm:py-3 rounded-lg hover:bg-opacity-90 transition-all duration-300 font-medium shadow-md text-sm sm:text-base">
                                        <span class="mr-2">📍</span>
                                        Lihat di Google Maps
                                    </a>
                                </div>
                            </div>
                            
                            <!-- Quick Info -->
                            <div class="space-y-3 sm:space-y-4">
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4">
                                    <div class="flex items-start space-x-2 sm:space-x-3">
                                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-sm sm:text-lg">🏢</span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <h4 class="font-semibold text-blue-800 mb-1 text-xs sm:text-sm">Alamat</h4>
                                            <p class="text-blue-700 text-xs leading-relaxed">
                                                Dinas Kependudukan dan Pencatatan Sipil<br>
                                                Kabupaten Kepulauan Tanimbar<br>
                                                Jl. Ir. Soekarno-Saumlaki<br>
                                                Provinsi Maluku
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4">
                                    <div class="flex items-start space-x-2 sm:space-x-3">
                                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-sm sm:text-lg">⏰</span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <h4 class="font-semibold text-green-800 mb-1 text-xs sm:text-sm">Jam Buka</h4>
                                            <div class="text-green-700 text-xs space-y-1">
                                                <p><strong>Sen-Jum:</strong> 08:00-16:00</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4">
                                    <div class="flex items-start space-x-2 sm:space-x-3">
                                        <div class="w-8 h-8 sm:w-10 sm:h-10 bg-orange-500 rounded-full flex items-center justify-center flex-shrink-0">
                                            <span class="text-white text-sm sm:text-lg">🚗</span>
                                        </div>
                                        <div class="min-w-0 flex-1">
                                            <h4 class="font-semibold text-orange-800 mb-1 text-xs sm:text-sm">Parkir</h4>
                                            <p class="text-orange-700 text-xs leading-relaxed">
                                                Area parkir tersedia untuk motor dan mobil
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="min-h-screen bg-gradient-to-br from-primary via-blue-600 to-purple-700 flex items-center justify-center p-4">
        <div class="w-full max-w-md">
            <!-- Logo and Title -->
            <div class="text-center mb-8">
                <img src="https://iili.io/KoUNepV.png" alt="Logo Walangaduk" class="h-20 w-20 mx-auto mb-4 object-contain">
                <h1 class="text-3xl font-bold text-white mb-2">Walangaduk</h1>
                <p class="text-white/80 text-sm">Sistem Administrasi Kependudukan Digital</p>
                <p class="text-white/70 text-xs mt-1">Kabupaten Kepulauan Tanimbar</p>
            </div>
            
            <!-- Login Card -->
            <div class="bg-white rounded-2xl shadow-2xl p-6 sm:p-8 animate-fade-in">
                <div class="text-center mb-6">
                    <div class="w-16 h-16 bg-gradient-to-br from-primary to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl text-white">🔐</span>
                    </div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-2">Masuk ke Sistem</h2>
                    <p class="text-gray-600 text-sm">Silakan masukkan kredensial Anda untuk melanjutkan</p>
                </div>
                
                <form id="loginForm" class="space-y-5">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <span class="flex items-center">
                                <span class="mr-2">👤</span>
                                Username
                            </span>
                        </label>
                        <input type="text" id="loginUsername" name="username" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm transition-all duration-300"
                               placeholder="Masukkan username Anda">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <span class="flex items-center">
                                <span class="mr-2">🔒</span>
                                Password
                            </span>
                        </label>
                        <div class="relative">
                            <input type="password" id="loginPassword" name="password" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm pr-12 transition-all duration-300"
                                   placeholder="Masukkan password Anda">
                            <button type="button" onclick="togglePasswordVisibility()" 
                                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors">
                                <span id="passwordToggleIcon">👁️</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <input type="checkbox" id="rememberMe" name="rememberMe" 
                                   class="h-4 w-4 text-primary border-gray-300 rounded focus:ring-primary">
                            <label for="rememberMe" class="ml-2 text-sm text-gray-700">Ingat saya</label>
                        </div>
                    </div>
                    
                    <div id="loginError" class="hidden bg-red-50 border border-red-200 rounded-lg p-3">
                        <div class="flex items-center">
                            <span class="text-red-500 mr-2">❌</span>
                            <p class="text-red-800 text-sm font-medium"></p>
                        </div>
                    </div>
                    
                    <div id="loginLoading" class="hidden text-center py-4">
                        <div class="inline-flex items-center">
                            <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-primary mr-3"></div>
                            <span class="text-gray-600">Memverifikasi kredensial...</span>
                        </div>
                    </div>
                    
                    <button type="submit" id="loginSubmitBtn" 
                            class="w-full bg-gradient-to-r from-primary to-blue-600 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-primary transition-all duration-300 shadow-lg transform hover:scale-105">
                        <span class="mr-2">🚀</span>
                        Masuk ke Aplikasi
                    </button>
                </form>
                
                <!-- User Info Display -->
                <div id="userInfo" class="hidden mt-6 bg-green-50 border border-green-200 rounded-lg p-4">
                    <div class="flex items-start space-x-3">
                        <span class="text-green-600 text-lg">✅</span>
                        <div>
                            <h4 class="text-green-800 font-semibold text-sm mb-1">Login Berhasil!</h4>
                            <div id="userDetails" class="text-green-700 text-xs space-y-1">
                                <!-- User details will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- System Info -->
                <div class="mt-6 text-center">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div class="flex items-start space-x-3">
                            <span class="text-blue-600 text-lg">ℹ️</span>
                            <div class="text-left">
                                <h4 class="text-blue-800 font-semibold text-sm mb-1">Informasi Sistem:</h4>
                                <p class="text-blue-700 text-xs leading-relaxed">
                                    Sistem terintegrasi dengan database pengguna terpusat. 
                                    Pengguna baru akan otomatis dapat mengakses sistem setelah didaftarkan oleh administrator.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Footer -->
                <div class="mt-6 text-center">
                    <p class="text-gray-500 text-xs">
                        © 2025 Dinas Kependudukan dan Pencatatan Sipil<br>
                        Kabupaten Kepulauan Tanimbar
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="gradient-bg text-white py-4 sm:py-6 md:py-8 mt-6 sm:mt-8 md:mt-12 lg:mt-16">
        <div class="container mx-auto px-3 sm:px-4 lg:px-6 text-center">
            <div class="flex flex-col items-center space-y-2 sm:space-y-3">
                <img src="https://iili.io/K9rv7pt.png" alt="Logo Footer" class="h-12 w-12 sm:h-16 sm:w-16 object-contain mx-auto">
                <p class="text-xs sm:text-sm md:text-base px-2 leading-relaxed max-w-2xl">
                    &copy; 2025 Aplikasi Walangaduk<br class="sm:hidden">
                    <span class="hidden sm:inline"> - </span>Dinas Kependudukan dan Pencatatan Sipil<br class="sm:hidden">
                    <span class="hidden sm:inline"> </span>Kabupaten Kepulauan Tanimbar
                </p>
                <p class="text-xs text-white/80">All rights reserved</p>
            </div>
        </div>
    </footer>



    <script>
        // Global variables
        let uploadedFiles = [];
        let isLoggedIn = false;
        let currentUser = null;
        let usersData = [];
        
        // Security features variables
        let cameraStream = null;
        let capturedPhotoData = null;
        let currentCaptcha = '';
        let isCaptchaVerified = false;
        let isBiometricVerified = false;

        // Desa data mapping
        const desaData = {
            "Tanimbar Selatan": ["Saumlaki", "Saumlaki Utara", "Wowonda", "Ilngei", "Kabiarat", "Lauran", "Sifnana", "Olilit Raya", "Lermatang", "Latdalam", "Bomaki", "Matakus"],
            "Selaru": ["Adaut", "Namtabung", "Kandar", "Lingat", "Fursuy", "Werain", "Eliasa"],
            "Wertamrian": ["Tumbur", "Lorulun", "Atubul Dol", "Amdasa", "Sangliat Krawain", "Arui Bab", "Arui Das", "Sangliat Dol", "Atubul Da"],
            "Wermaktian": ["Kamatubun", "Rumah Salut", "Welutu", "Themin", "Weratan", "Wermatan", "Otemer", "Makatian", "Marantutul"],
            "Tanimbar Utara": ["Lelingluan", "Ritabel", "Ridool", "Watidal", "Keliobar", "Kelaan", "Lamdesar Barat", "Lamdesar Timur"],
            "Fordata": ["Romean", "Rumngeur", "Awear", "Sofyanin", "Walerang", "Adodo Fordata"],
            "Wuarlabobar": ["Abat", "Labobar", "Watmasa", "Awear Rumngeur", "Karatat", "Wunlah", "Kiloon", "Lingada", "Teineman", "Wabar", "Romnus"],
            "Kormomolin": ["Lumasebu", "Kilmasa", "Meyano Bab", "Alusi Krawain", "Alusi Kelaan", "Alusi Bukjalim", "Alusi Tamrian", "Alusi Batjas", "Lorwembun", "Meyano Das"],
            "Nirunmas": ["Arma", "Watmuri", "Manglusi", "Tutukembong", "Waturu"],
            "Molumaru": ["Wedangkou", "Adodo Molu", "Wulmasa", "Tutunametal", "Nurkat"]
        };

        // Service type icons and names
        const serviceIcons = {
            'KK': '👨‍👩‍👧‍👦',
            'KTP EL': '🆔',
            'KIA': '👶',
            'SKPWNI': '📤',
            'SKDWNI': '📥',
            'Akta Kelahiran': '🍼',
            'Akta Kematian': '⚰️'
        };

        const serviceNames = {
            'KK': 'Kartu Keluarga',
            'KTP EL': 'KTP Elektronik',
            'KIA': 'Kartu Identitas Anak',
            'SKPWNI': 'SK Pindah WNI',
            'SKDWNI': 'SK Datang WNI',
            'Akta Kelahiran': 'Akta Kelahiran',
            'Akta Kematian': 'Akta Kematian'
        };

        // Mobile menu toggle
        function toggleMenu() {
            const mobileMenu = document.getElementById('mobile-menu');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            
            if (mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.remove('hidden');
                mobileMenu.classList.add('mobile-menu-enter');
                hamburgerBtn.classList.add('hamburger-active');
                
                setTimeout(() => {
                    mobileMenu.classList.remove('mobile-menu-enter');
                }, 300);
            } else {
                mobileMenu.classList.add('mobile-menu-exit');
                hamburgerBtn.classList.remove('hamburger-active');
                
                setTimeout(() => {
                    mobileMenu.classList.add('hidden');
                    mobileMenu.classList.remove('mobile-menu-exit');
                }, 300);
            }
        }

        // Load user credentials from Google Sheets
        async function loadCredentials() {
            try {
                console.log('📊 Memuat data pengguna dari Google Sheets...');
                
                const response = await fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vQe1VRxHbaCptL3iB_UUitoRw_BF6DRWSuUw3-w5evnSe-nxUPGLKo7TNSjy8rwL8r0nL5RHmK2ALiy/pub?gid=990672237&single=true&output=csv');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const csvText = await response.text();
                const lines = csvText.split('\n');
                
                // Skip header row and parse data
                // Expected format: username, password, nama lengkap, nik, kecamatan, desa, status
                usersData = [];
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line) {
                        const columns = line.split(',').map(col => col.replace(/"/g, '').trim());
                        if (columns.length >= 7) {
                            usersData.push({
                                username: columns[0],
                                password: columns[1],
                                namaLengkap: columns[2],
                                nik: columns[3],
                                kecamatan: columns[4],
                                desa: columns[5],
                                status: columns[6].toLowerCase()
                            });
                        }
                    }
                }
                
                console.log(`✅ Berhasil memuat ${usersData.length} data pengguna`);
                console.log('📋 Sample data:', usersData.slice(0, 2)); // Log first 2 users for debugging
                return true;
                
            } catch (error) {
                console.error('❌ Error memuat data pengguna:', error);
                showMessage('⚠️ Gagal memuat data pengguna. Menggunakan mode offline.', 'warning', 5000);
                return false;
            }
        }

        // Handle login form submission
        async function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            if (!username || !password) {
                showLoginError('Username dan password harus diisi');
                return;
            }
            
            // Show loading state
            showLoginLoading(true);
            hideLoginError();
            
            try {
                // Load fresh data from Google Sheets
                await loadCredentials();
                
                // Find user in data
                const user = usersData.find(u => 
                    u.username.toLowerCase() === username.toLowerCase() && 
                    u.password === password
                );
                
                if (!user) {
                    throw new Error('Username atau password salah');
                }
                
                if (user.status !== 'aktif') {
                    throw new Error('Akun Anda tidak aktif. Silakan hubungi administrator');
                }
                
                // Successful login
                isLoggedIn = true;
                currentUser = user;
                
                // Save session if remember me is checked
                if (rememberMe) {
                    localStorage.setItem('walangaduk_session', JSON.stringify({
                        username: user.username,
                        namaLengkap: user.namaLengkap,
                        loginTime: new Date().toISOString()
                    }));
                }
                
                // Show user info
                showUserInfo(user);
                
                // Redirect to dashboard after 2 seconds
                setTimeout(() => {
                    hideLoginPage();
                    showPage('dashboard');
                    showMessage(`🎉 Selamat datang, ${user.namaLengkap}! Anda berhasil masuk ke sistem Walangaduk.`, 'success', 5000);
                }, 2000);
                
                console.log('✅ Login berhasil:', user);
                
            } catch (error) {
                console.error('❌ Login gagal:', error);
                showLoginError(error.message);
            } finally {
                showLoginLoading(false);
            }
        }

        // Show/hide login page
        function showLoginPage() {
            document.getElementById('loginPage').classList.remove('hidden');
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            document.querySelector('header').classList.add('hidden');
            document.querySelector('nav').classList.add('hidden');
            document.querySelector('footer').classList.add('hidden');
            
            // Focus on username input
            setTimeout(() => {
                document.getElementById('loginUsername').focus();
            }, 100);
        }

        function hideLoginPage() {
            document.getElementById('loginPage').classList.add('hidden');
            document.querySelector('header').classList.remove('hidden');
            document.querySelector('nav').classList.remove('hidden');
            document.querySelector('footer').classList.remove('hidden');
            document.getElementById('loginForm').reset();
            hideLoginError();
            showLoginLoading(false);
            document.getElementById('userInfo').classList.add('hidden');
        }

        // Show user info after successful login
        function showUserInfo(user) {
            const userInfo = document.getElementById('userInfo');
            const userDetails = document.getElementById('userDetails');
            
            userDetails.innerHTML = `
                <p><strong>Nama:</strong> ${user.namaLengkap}</p>
                <p><strong>Username:</strong> ${user.username}</p>
                <p><strong>NIK:</strong> ${user.nik}</p>
                <p><strong>Lokasi:</strong> ${user.desa}, ${user.kecamatan}</p>
                <p><strong>Status:</strong> <span class="text-green-600 font-semibold">${user.status.toUpperCase()}</span></p>
            `;
            
            userInfo.classList.remove('hidden');
        }

        // Login UI helpers
        function showLoginError(message) {
            const errorDiv = document.getElementById('loginError');
            errorDiv.querySelector('p').textContent = message;
            errorDiv.classList.remove('hidden');
        }

        function hideLoginError() {
            document.getElementById('loginError').classList.add('hidden');
        }

        function showLoginLoading(show) {
            const loadingDiv = document.getElementById('loginLoading');
            const submitBtn = document.getElementById('loginSubmitBtn');
            
            if (show) {
                loadingDiv.classList.remove('hidden');
                submitBtn.disabled = true;
                submitBtn.classList.add('opacity-50');
            } else {
                loadingDiv.classList.add('hidden');
                submitBtn.disabled = false;
                submitBtn.classList.remove('opacity-50');
            }
        }

        // Toggle password visibility
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('loginPassword');
            const toggleIcon = document.getElementById('passwordToggleIcon');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.textContent = '🙈';
            } else {
                passwordInput.type = 'password';
                toggleIcon.textContent = '👁️';
            }
        }

        // Logout function
        function logout() {
            if (confirm('Apakah Anda yakin ingin keluar dari aplikasi?')) {
                isLoggedIn = false;
                currentUser = null;
                
                // Clear saved session
                localStorage.removeItem('walangaduk_session');
                
                // Show login page
                showLoginPage();
                
                showMessage('👋 Anda telah berhasil logout. Terima kasih telah menggunakan Walangaduk.', 'info', 4000);
                
                console.log('🚪 User logout');
            }
        }

        // Check existing session
        function checkExistingSession() {
            const savedSession = localStorage.getItem('walangaduk_session');
            
            if (savedSession) {
                try {
                    const session = JSON.parse(savedSession);
                    const loginTime = new Date(session.loginTime);
                    const now = new Date();
                    const hoursDiff = (now - loginTime) / (1000 * 60 * 60);
                    
                    // Session expires after 24 hours
                    if (hoursDiff < 24) {
                        // Auto-login with saved session
                        isLoggedIn = true;
                        currentUser = { 
                            username: session.username,
                            namaLengkap: session.namaLengkap || session.username
                        };
                        
                        hideLoginPage();
                        showPage('dashboard');
                        showMessage(`👋 Selamat datang kembali, ${session.namaLengkap || session.username}!`, 'success', 3000);
                        
                        console.log('🔄 Auto-login dari session tersimpan');
                        return true;
                    } else {
                        // Session expired
                        localStorage.removeItem('walangaduk_session');
                    }
                } catch (error) {
                    console.error('❌ Error parsing saved session:', error);
                    localStorage.removeItem('walangaduk_session');
                }
            }
            
            return false;
        }

        // Navigation functions with login check
        function showPage(pageId) {
            // Check if user is logged in
            if (!isLoggedIn) {
                showLoginPage();
                return;
            }
            
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
            });
            
            document.getElementById(pageId).classList.remove('hidden');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('text-primary');
            });
            
            document.querySelectorAll('.nav-btn-mobile').forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white');
                btn.classList.add('text-primary');
            });
            
            if (event && event.target) {
                event.target.classList.add('bg-primary', 'text-white');
                event.target.classList.remove('text-primary');
            }
        }

        // Update desa dropdown
        function updateDesa() {
            const kecamatan = document.getElementById('kecamatan').value;
            const desaSelect = document.getElementById('desa');
            
            desaSelect.innerHTML = '<option value="">Pilih Desa</option>';
            
            if (kecamatan && desaData[kecamatan]) {
                desaData[kecamatan].forEach(desa => {
                    const option = document.createElement('option');
                    option.value = desa;
                    option.textContent = desa;
                    desaSelect.appendChild(option);
                });
            }
        }

        // Handle file upload
        function handleFileUpload(event) {
            const files = event.target.files;
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            uploadedFiles = [];
            
            Array.from(files).forEach((file, index) => {
                if (file.size > 5 * 1024 * 1024) {
                    alert(`File ${file.name} terlalu besar. Maksimal 5MB.`);
                    return;
                }
                
                const fileItem = document.createElement('div');
                fileItem.className = 'flex items-center justify-between bg-white p-3 rounded border mb-2';
                fileItem.innerHTML = `
                    <div class="flex items-center space-x-2">
                        <span class="text-lg">${file.type.includes('pdf') ? '📄' : '🖼️'}</span>
                        <span class="text-sm text-gray-700">${file.name}</span>
                    </div>
                    <div class="text-right">
                        <span class="text-xs text-gray-500">${(file.size / 1024 / 1024).toFixed(2)} MB</span>
                        <div class="text-xs text-green-600 mt-1">✓ Siap upload</div>
                    </div>
                `;
                fileList.appendChild(fileItem);
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        // Get base64 data without data URL prefix
                        const base64Data = e.target.result.split(',')[1];
                        
                        // Create file object with proper structure for Google Apps Script
                        const fileObj = {
                            name: file.name,
                            type: file.type,
                            size: file.size,
                            data: base64Data,
                            lastModified: file.lastModified || Date.now()
                        };
                        
                        uploadedFiles.push(fileObj);
                        
                        console.log(`✅ File ${file.name} siap untuk upload:`, {
                            name: fileObj.name,
                            type: fileObj.type,
                            size: `${(fileObj.size / 1024 / 1024).toFixed(2)} MB`,
                            dataLength: base64Data.length
                        });
                        
                    } catch (error) {
                        console.error(`❌ Error processing file ${file.name}:`, error);
                        showMessage(`❌ Error memproses file ${file.name}`, 'error', 4000);
                    }
                };
                
                reader.onerror = function(error) {
                    console.error(`❌ Error reading file ${file.name}:`, error);
                    showMessage(`❌ Error membaca file ${file.name}`, 'error', 4000);
                };
                
                reader.readAsDataURL(file);
            });
            
            if (files.length > 0) {
                showMessage(`📁 ${files.length} file berhasil dipilih dan siap untuk diupload.`, 'success', 3000);
            }
        }

        // Biometric Camera Functions
        async function startCamera() {
            try {
                console.log('🎥 Memulai kamera untuk verifikasi biometrik...');
                
                const video = document.getElementById('cameraVideo');
                const placeholder = document.getElementById('cameraPlaceholder');
                const startBtn = document.getElementById('startCameraBtn');
                const captureBtn = document.getElementById('captureBtn');
                
                // Check if browser supports getUserMedia
                if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                    throw new Error('Browser tidak mendukung akses kamera');
                }
                
                // Stop any existing stream first
                stopCamera();
                
                // Request camera access with fallback options
                const constraints = {
                    video: {
                        width: { ideal: 640, min: 320, max: 1280 },
                        height: { ideal: 480, min: 240, max: 720 },
                        facingMode: 'user' // Front camera preferred
                    },
                    audio: false
                };
                
                try {
                    cameraStream = await navigator.mediaDevices.getUserMedia(constraints);
                } catch (frontCameraError) {
                    console.warn('⚠️ Front camera gagal, mencoba kamera lain...');
                    // Try without facingMode constraint
                    const fallbackConstraints = {
                        video: {
                            width: { ideal: 640, min: 320 },
                            height: { ideal: 480, min: 240 }
                        },
                        audio: false
                    };
                    cameraStream = await navigator.mediaDevices.getUserMedia(fallbackConstraints);
                }
                
                // Set video source and wait for it to load
                video.srcObject = cameraStream;
                
                // Wait for video to be ready
                await new Promise((resolve, reject) => {
                    video.onloadedmetadata = () => {
                        video.play().then(resolve).catch(reject);
                    };
                    video.onerror = reject;
                    
                    // Timeout after 10 seconds
                    setTimeout(() => reject(new Error('Timeout loading video')), 10000);
                });
                
                // Show video stream
                video.classList.remove('hidden');
                placeholder.classList.add('hidden');
                
                // Update buttons
                startBtn.classList.add('hidden');
                captureBtn.classList.remove('hidden');
                
                // Show success message
                showMessage('✅ Kamera berhasil diaktifkan! Posisikan wajah Anda di tengah frame dan pastikan pencahayaan cukup.', 'success', 5000);
                
                console.log('✅ Kamera berhasil diaktifkan');
                
            } catch (error) {
                console.error('❌ Error mengakses kamera:', error);
                
                let errorMessage = '❌ Gagal mengakses kamera. ';
                if (error.name === 'NotAllowedError' || error.name === 'PermissionDeniedError') {
                    errorMessage += 'Silakan izinkan akses kamera di browser Anda.';
                } else if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {
                    errorMessage += 'Kamera tidak ditemukan pada perangkat Anda.';
                } else if (error.name === 'NotSupportedError' || error.name === 'ConstraintNotSatisfiedError') {
                    errorMessage += 'Browser atau perangkat tidak mendukung fitur kamera.';
                } else if (error.message.includes('Timeout')) {
                    errorMessage += 'Timeout saat memuat kamera. Silakan coba lagi.';
                } else {
                    errorMessage += 'Silakan periksa koneksi kamera dan coba lagi.';
                }
                
                showMessage(errorMessage, 'error', 8000);
                
                // Reset camera UI
                resetCameraUI();
            }
        }

        function stopCamera() {
            if (cameraStream) {
                cameraStream.getTracks().forEach(track => {
                    track.stop();
                });
                cameraStream = null;
                console.log('🛑 Kamera dihentikan');
            }
        }

        function resetCameraUI() {
            const video = document.getElementById('cameraVideo');
            const placeholder = document.getElementById('cameraPlaceholder');
            const startBtn = document.getElementById('startCameraBtn');
            const captureBtn = document.getElementById('captureBtn');
            const retakeBtn = document.getElementById('retakeBtn');
            
            video.classList.add('hidden');
            placeholder.classList.remove('hidden');
            startBtn.classList.remove('hidden');
            captureBtn.classList.add('hidden');
            retakeBtn.classList.add('hidden');
            
            stopCamera();
        }

        function capturePhoto() {
            try {
                const video = document.getElementById('cameraVideo');
                const canvas = document.getElementById('cameraCanvas');
                const capturedPhoto = document.getElementById('capturedPhoto');
                const photoPlaceholder = document.getElementById('photoPlaceholder');
                const biometricStatus = document.getElementById('biometricStatus');
                const captureBtn = document.getElementById('captureBtn');
                const retakeBtn = document.getElementById('retakeBtn');
                
                if (!video.videoWidth || !video.videoHeight) {
                    throw new Error('Video belum siap untuk diambil foto');
                }
                
                // Set canvas dimensions to match video
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                
                // Draw video frame to canvas
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // Convert to data URL
                capturedPhotoData = canvas.toDataURL('image/jpeg', 0.8);
                
                // Show captured photo
                capturedPhoto.src = capturedPhotoData;
                capturedPhoto.classList.remove('hidden');
                photoPlaceholder.classList.add('hidden');
                
                // Update buttons
                captureBtn.classList.add('hidden');
                retakeBtn.classList.remove('hidden');
                
                // Show success status
                biometricStatus.classList.remove('hidden');
                isBiometricVerified = true;
                
                // Stop camera after successful capture
                stopCamera();
                resetCameraUI();
                
                showMessage('📸 Foto berhasil diambil! Verifikasi biometrik siap untuk diproses.', 'success', 4000);
                
                console.log('✅ Foto biometrik berhasil diambil');
                
            } catch (error) {
                console.error('❌ Error mengambil foto:', error);
                showMessage('❌ Gagal mengambil foto. Silakan coba lagi.', 'error', 4000);
            }
        }

        function retakePhoto() {
            // Reset photo capture
            const capturedPhoto = document.getElementById('capturedPhoto');
            const photoPlaceholder = document.getElementById('photoPlaceholder');
            const biometricStatus = document.getElementById('biometricStatus');
            
            capturedPhoto.classList.add('hidden');
            photoPlaceholder.classList.remove('hidden');
            biometricStatus.classList.add('hidden');
            
            capturedPhotoData = null;
            isBiometricVerified = false;
            
            // Restart camera
            startCamera();
            
            showMessage('🔄 Siap untuk mengambil foto ulang.', 'info', 3000);
        }

        // CAPTCHA Functions
        function generateCaptcha() {
            const canvas = document.getElementById('captchaCanvas');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Generate random 6-character string
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            currentCaptcha = '';
            for (let i = 0; i < 6; i++) {
                currentCaptcha += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            // Set background
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Add noise lines
            ctx.strokeStyle = '#dee2e6';
            ctx.lineWidth = 1;
            for (let i = 0; i < 5; i++) {
                ctx.beginPath();
                ctx.moveTo(Math.random() * canvas.width, Math.random() * canvas.height);
                ctx.lineTo(Math.random() * canvas.width, Math.random() * canvas.height);
                ctx.stroke();
            }
            
            // Draw CAPTCHA text
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            const colors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12', '#9b59b6', '#1abc9c'];
            
            for (let i = 0; i < currentCaptcha.length; i++) {
                ctx.fillStyle = colors[i % colors.length];
                const x = 35 + (i * 25);
                const y = 40 + (Math.random() - 0.5) * 10;
                const angle = (Math.random() - 0.5) * 0.3;
                
                ctx.save();
                ctx.translate(x, y);
                ctx.rotate(angle);
                ctx.fillText(currentCaptcha[i], 0, 0);
                ctx.restore();
            }
            
            // Add noise dots
            ctx.fillStyle = '#adb5bd';
            for (let i = 0; i < 20; i++) {
                ctx.beginPath();
                ctx.arc(Math.random() * canvas.width, Math.random() * canvas.height, 1, 0, 2 * Math.PI);
                ctx.fill();
            }
            
            // Reset verification status
            isCaptchaVerified = false;
            document.getElementById('captchaStatus').classList.add('hidden');
            document.getElementById('captchaInput').value = '';
            
            console.log('🔄 CAPTCHA baru dibuat:', currentCaptcha);
        }

        function verifyCaptcha() {
            const input = document.getElementById('captchaInput').value.toUpperCase().trim();
            const statusDiv = document.getElementById('captchaStatus');
            
            if (!input) {
                showCaptchaStatus('⚠️ Silakan masukkan kode CAPTCHA terlebih dahulu.', 'warning');
                return;
            }
            
            if (input === currentCaptcha) {
                isCaptchaVerified = true;
                showCaptchaStatus('✅ CAPTCHA berhasil diverifikasi!', 'success');
                showMessage('✅ Verifikasi CAPTCHA berhasil!', 'success', 3000);
            } else {
                isCaptchaVerified = false;
                showCaptchaStatus('❌ Kode CAPTCHA salah. Silakan coba lagi.', 'error');
                
                // Generate new CAPTCHA after failed attempt
                setTimeout(() => {
                    generateCaptcha();
                }, 1500);
            }
        }

        function showCaptchaStatus(message, type) {
            const statusDiv = document.getElementById('captchaStatus');
            
            let bgColor, borderColor, textColor;
            
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-50';
                    borderColor = 'border-green-200';
                    textColor = 'text-green-800';
                    break;
                case 'error':
                    bgColor = 'bg-red-50';
                    borderColor = 'border-red-200';
                    textColor = 'text-red-800';
                    break;
                case 'warning':
                    bgColor = 'bg-yellow-50';
                    borderColor = 'border-yellow-200';
                    textColor = 'text-yellow-800';
                    break;
                default:
                    bgColor = 'bg-gray-50';
                    borderColor = 'border-gray-200';
                    textColor = 'text-gray-800';
            }
            
            statusDiv.className = `${bgColor} ${borderColor} rounded-lg p-3 border`;
            statusDiv.innerHTML = `<p class="${textColor} text-sm font-medium">${message}</p>`;
            statusDiv.classList.remove('hidden');
        }

        // Form submission to Google Sheets
        document.getElementById('registrationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Validate biometric verification
            if (!isBiometricVerified) {
                showMessage('❌ Silakan ambil foto untuk verifikasi biometrik terlebih dahulu.', 'error', 5000);
                return;
            }
            
            // Validate CAPTCHA verification
            if (!isCaptchaVerified) {
                showMessage('❌ Silakan verifikasi CAPTCHA terlebih dahulu.', 'error', 5000);
                return;
            }
            
            // Show loading state
            const submitBtn = e.target.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="mr-2">⏳</span>Mengirim Data...';
            submitBtn.disabled = true;
            
            try {
                // Collect form data
                const formData = new FormData(e.target);
                
                // Create timestamp in Indonesian format
                const now = new Date();
                const timestamp = now.toLocaleString('id-ID', {
                    timeZone: 'Asia/Jayapura',
                    day: '2-digit',
                    month: '2-digit', 
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
                
                // Prepare data with exact column mapping for Google Sheets
                const registrationData = {
                    Timestamp: timestamp,
                    tanggal: formData.get('tanggal') || '',
                    jenipelaporan: formData.get('jenipelaporan') || '',
                    namapetugas: formData.get('namapetugas') || '',
                    nip: formData.get('nip') || '',
                    namainstansi: formData.get('namainstansi') || '',
                    telp: formData.get('telp') || '',
                    email: formData.get('email') || '',
                    namalengkap: formData.get('namalengkap') || '',
                    tempatlahir: formData.get('tempatlahir') || '',
                    tanggallahir: formData.get('tanggallahir') || '',
                    jeniskelamin: formData.get('jeniskelamin') || '',
                    namaibu: formData.get('namaibu') || '',
                    namaayah: formData.get('namaayah') || '',
                    kecamatan: formData.get('kecamatan') || '',
                    desakelurahan: formData.get('desakelurahan') || '',
                    rtrw: formData.get('rtrw') || '',
                    syaratdanketentuan: formData.get('syaratdanketentuan') ? 'Disetujui' : 'Tidak Disetujui',
                    // Send files as properly formatted JSON string
                    unggahberkas: uploadedFiles.length > 0 ? JSON.stringify(uploadedFiles) : 'Tidak ada file',
                    // Add biometric photo data
                    fotobiometrik: capturedPhotoData || 'Tidak ada foto'
                };
                
                console.log('📤 Mengirim data registrasi ke Google Sheets:', {
                    ...registrationData,
                    unggahberkas: uploadedFiles.length > 0 ? `${uploadedFiles.length} file(s) ready` : 'Tidak ada file',
                    fotobiometrik: capturedPhotoData ? 'Foto biometrik tersedia' : 'Tidak ada foto'
                });
                
                // Log file details for debugging
                if (uploadedFiles.length > 0) {
                    console.log('📁 Detail file yang akan diupload:');
                    uploadedFiles.forEach((file, index) => {
                        console.log(`   ${index + 1}. ${file.name} (${file.type}) - ${(file.size / 1024 / 1024).toFixed(2)} MB`);
                    });
                }
                
                // Method 1: Try with form data approach
                const formDataToSend = new FormData();
                Object.keys(registrationData).forEach(key => {
                    if (key === 'unggahberkas' && uploadedFiles.length > 0) {
                        // Send files as JSON string for proper handling
                        formDataToSend.append(key, JSON.stringify(uploadedFiles));
                    } else {
                        formDataToSend.append(key, registrationData[key]);
                    }
                });
                
                let success = false;
                let response;
                
                try {
                    // First attempt: POST with FormData
                    response = await fetch('https://script.google.com/macros/s/AKfycbzXHmFFsuoKhRFWv0aYBDc47QyKstUDxxHHpvbfZDNG7EQj7EDeis-LGWpMqz7tH7-5Og/exec', {
                        method: 'POST',
                        body: formDataToSend
                    });
                    
                    if (response.ok) {
                        success = true;
                        console.log('✅ Data berhasil dikirim dengan FormData');
                    }
                } catch (error) {
                    console.warn('⚠️ FormData method failed, trying JSON method...');
                }
                
                // Method 2: If FormData fails, try JSON approach
                if (!success) {
                    try {
                        response = await fetch('https://script.google.com/macros/s/AKfycbzXHmFFsuoKhRFWv0aYBDc47QyKstUDxxHHpvbfZDNG7EQj7EDeis-LGWpMqz7tH7-5Og/exec', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(registrationData)
                        });
                        
                        if (response.ok) {
                            success = true;
                            console.log('✅ Data berhasil dikirim dengan JSON');
                        }
                    } catch (error) {
                        console.warn('⚠️ JSON method failed, trying GET method...');
                    }
                }
                
                // Method 3: If both fail, try GET with URL parameters
                if (!success) {
                    try {
                        const params = new URLSearchParams();
                        Object.keys(registrationData).forEach(key => {
                            params.append(key, registrationData[key]);
                        });
                        
                        response = await fetch(`https://script.google.com/macros/s/AKfycbzXHmFFsuoKhRFWv0aYBDc47QyKstUDxxHHpvbfZDNG7EQj7EDeis-LGWpMqz7tH7-5Og/exec?${params.toString()}`, {
                            method: 'GET'
                        });
                        
                        if (response.ok) {
                            success = true;
                            console.log('✅ Data berhasil dikirim dengan GET parameters');
                        }
                    } catch (error) {
                        console.error('❌ Semua method gagal:', error);
                    }
                }
                
                if (success) {
                    // Try to read response if possible
                    try {
                        const responseText = await response.text();
                        console.log('📋 Response dari server:', responseText);
                        
                        if (responseText.includes('success') || responseText.includes('berhasil')) {
                            showMessage('🎉 Data registrasi berhasil dikirim ke database Google Sheets! Terima kasih telah menggunakan layanan Walangaduk.', 'success', 8000);
                        } else {
                            showMessage('⚠️ Data terkirim ke server, namun status tidak dapat dikonfirmasi. Silakan periksa Google Sheets Anda.', 'warning', 6000);
                        }
                    } catch (responseError) {
                        // Even if we can't read response, if fetch succeeded, data likely went through
                        showMessage('✅ Data berhasil dikirim ke database! Silakan periksa Google Sheets untuk konfirmasi.', 'success', 6000);
                    }
                    
                    // Log success with detailed info
                    console.log('✅ Data berhasil dikirim ke Google Sheets dengan mapping kolom:');
                    console.log('📊 Kolom yang dikirim:', Object.keys(registrationData));
                    console.log('📋 Data lengkap:', registrationData);
                    
                    // Reset form after successful submission
                    setTimeout(() => {
                        // Reset form
                        e.target.reset();
                        uploadedFiles = [];
                        document.getElementById('fileList').innerHTML = '';
                        
                        // Reset desa dropdown
                        document.getElementById('desa').innerHTML = '<option value="">Pilih Desa</option>';
                        
                        // Reset biometric
                        const capturedPhoto = document.getElementById('capturedPhoto');
                        const photoPlaceholder = document.getElementById('photoPlaceholder');
                        const biometricStatus = document.getElementById('biometricStatus');
                        
                        capturedPhoto.classList.add('hidden');
                        photoPlaceholder.classList.remove('hidden');
                        biometricStatus.classList.add('hidden');
                        capturedPhotoData = null;
                        isBiometricVerified = false;
                        
                        // Reset camera UI
                        resetCameraUI();
                        
                        // Reset CAPTCHA
                        generateCaptcha();
                        
                        showMessage('✨ Form telah direset dan siap untuk registrasi baru.', 'info', 3000);
                    }, 1500);
                    
                } else {
                    throw new Error('Semua metode pengiriman gagal');
                }
                
            } catch (error) {
                console.error('❌ Error mengirim data ke Google Sheets:', error);
                
                let errorMessage = '❌ Terjadi kesalahan saat mengirim data ke database. ';
                
                if (error.name === 'TypeError' && error.message.includes('fetch')) {
                    errorMessage += 'Periksa koneksi internet Anda dan coba lagi.';
                } else if (error.message.includes('CORS')) {
                    errorMessage += 'Masalah CORS terdeteksi. Pastikan Google Apps Script sudah di-deploy dengan benar.';
                } else if (error.message.includes('404')) {
                    errorMessage += 'URL Google Apps Script tidak ditemukan. Periksa URL deployment.';
                } else {
                    errorMessage += 'Silakan coba lagi dalam beberapa saat atau hubungi administrator.';
                }
                
                showMessage(errorMessage, 'error', 8000);
                
                // Show additional debugging info
                console.log('🔍 Debug Info:');
                console.log('📋 Data yang gagal dikirim:', registrationData);
                console.log('🔗 URL endpoint yang dicoba:');
                console.log('   - POST FormData: https://script.google.com/macros/s/AKfycbzXHmFFsuoKhRFWv0aYBDc47QyKstUDxxHHpvbfZDNG7EQj7EDeis-LGWpMqz7tH7-5Og/exec');
                console.log('   - POST JSON: https://script.google.com/macros/s/AKfycbzXHmFFsuoKhRFWv0aYBDc47QyKstUDxxHHpvbfZDNG7EQj7EDeis-LGWpMqz7tH7-5Og/exec');
                console.log('   - GET Params: https://script.google.com/macros/s/AKfycbzXHmFFsuoKhRFWv0aYBDc47QyKstUDxxHHpvbfZDNG7EQj7EDeis-LGWpMqz7tH7-5Og/exec');
                console.log('💡 Saran: Pastikan Google Apps Script sudah di-deploy sebagai web app dengan akses "Anyone"');
            } finally {
                // Restore button
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }
        });

        // Contact form submission
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const nama = formData.get('nama');
            const whatsapp = formData.get('whatsapp');
            const email = formData.get('email');
            const pesan = formData.get('pesan');
            
            // Format WhatsApp message
            const message = `Halo, saya ${nama}.\n\nEmail: ${email}\n\nPesan: ${pesan}\n\nTerima kasih.`;
            const encodedMessage = encodeURIComponent(message);
            const whatsappUrl = `https://wa.me/${whatsapp}?text=${encodedMessage}`;
            
            // Open WhatsApp
            window.open(whatsappUrl, '_blank');
            
            // Show success message
            showMessage('📱 Pesan berhasil disiapkan! WhatsApp akan terbuka untuk mengirim pesan.', 'success', 5000);
            
            // Reset form
            e.target.reset();
        });

        // Utility function to show messages
        function showMessage(message, type = 'info', duration = 4000) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `fixed top-4 right-4 z-50 max-w-sm p-4 rounded-lg shadow-lg animate-fade-in`;
            
            let bgColor, textColor, borderColor;
            
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-500';
                    textColor = 'text-white';
                    borderColor = 'border-green-600';
                    break;
                case 'error':
                    bgColor = 'bg-red-500';
                    textColor = 'text-white';
                    borderColor = 'border-red-600';
                    break;
                case 'warning':
                    bgColor = 'bg-yellow-500';
                    textColor = 'text-white';
                    borderColor = 'border-yellow-600';
                    break;
                default:
                    bgColor = 'bg-blue-500';
                    textColor = 'text-white';
                    borderColor = 'border-blue-600';
            }
            
            messageDiv.className += ` ${bgColor} ${textColor} border ${borderColor}`;
            messageDiv.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-1">
                        <p class="text-sm font-medium">${message}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="ml-3 text-white hover:text-gray-200">
                        <span class="text-lg">×</span>
                    </button>
                </div>
            `;
            
            document.body.appendChild(messageDiv);
            
            // Auto remove after duration
            setTimeout(() => {
                if (document.body.contains(messageDiv)) {
                    messageDiv.remove();
                }
            }, duration);
        }

        // Update current date and time
        function updateDateTime() {
            const now = new Date();
            const options = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'Asia/Jayapura'
            };
            
            const dateTimeString = now.toLocaleDateString('id-ID', options) + ' WIT';
            document.getElementById('currentDateTime').textContent = dateTimeString;
        }

        // Initialize application
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🚀 Aplikasi Walangaduk dimulai');
            
            // Update date and time
            updateDateTime();
            setInterval(updateDateTime, 60000); // Update every minute
            
            // Generate initial CAPTCHA
            generateCaptcha();
            
            // Add login form event listener
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            
            // Load user credentials
            await loadCredentials();
            
            // Check for existing session
            const hasSession = checkExistingSession();
            
            if (!hasSession) {
                // Show login page if no valid session
                showLoginPage();
            }
            
            console.log('✅ Aplikasi Walangaduk siap digunakan');
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', function() {
            stopCamera();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98a2b282a7086034',t:'MTc1OTcyNzg5OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
